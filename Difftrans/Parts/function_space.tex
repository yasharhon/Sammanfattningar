\section{Funktioner, vektorrum och dylikt}

\subsection{Definitioner}

\paragraph{Inreprodukt}
På kontinuerliga funktioner $[-\pi, \pi] \to \C$ definierar vi inreprodukten
\begin{align*}
	\inprod{u}{v} = \frac{1}{2\pi}\inteval{-\pi}{\pi}{u(t)\cc{v}(t)}{t}.
\end{align*}

\paragraph{Fullständiga mängder}
Låt $\left\{e_{i}\right\}_{i\in I}$ vara en ortonormal mängd vektorer i $V$. Då är $\left\{e_{i}\right\}_{i\in I}$ en fullständig mängd i $V$ om det för varje $u\in V$ och $\varepsilon >0 \exists N >0$ så att
\begin{align*}
	n > N\implies \abs{u - \sum\limits_{i\in I}\inprod{u}{e_{i}}e_{i}} < \varepsilon.
\end{align*}

\paragraph{$\ell^{2}$}
Vi definierar $\ell^{2}(\Z)$ som mängden av alla följder av komplexa tal med inreprodukt
\begin{align*}
	\inprod{u}{v} = \sum\limits_{i = 0}^{n}a_{i}\cc{b_{i}}.
\end{align*}

\paragraph{$L^{2}$}
Vi definierar $L^{2}([-\pi, \pi], \C)$ som mängden av alla komplexvärda Riemannintegrerbara funktioner på $[-\pi, \pi]$ med inreprodukten
\begin{align*}
	\inprod{u}{v} = \frac{1}{2\pi}\inteval{-\pi}{\pi}{u(x)\cc{v}(x)}{x}.
\end{align*}
I denna klassen definieras två funktioner som lika om $\norm{u - v} = 0$.

\paragraph{Legendrepolynomen}
Legendrepolynomen är en följd av polynom så att $p_{0}(x) = 1$, $p_{i}(1) = 1$ och $p_{n}$ är ortogonal på $p_{0}, \dots, p_{n - 1}$ med inreprodukten
\begin{align*}
	\inprod{u}{v} = \inteval{-1}{1}{u(x)\cc{v}(x)}{x}.
\end{align*}

\paragraph{Hermiteska operatorer}
En Hermitesk operator uppfyller $\inprod{Av}{w} = \inprod{v}{Aw}$. Se sammanfattningen från SF1681 för mer information.

\paragraph{Sturm-Liouville-operatorn}
Sturm-Liouville-operatorn är en operator $L: C^{2}([a, b], \C) \to L^{2}([a, b], \C)$ definierat som
\begin{align*}
	L(f) = \dv{x}\left(p(x)\deval{f}{x}{x}\right) + q(x)f(x) + \lambda w(x)f(x).
\end{align*}

\paragraph{Reguljära Sturm-Liouvilleproblem}
Ekvationen
\begin{align*}
	&\dv{x}\left(p(x)\deval{f}{x}{x}\right) + q(x)f(x) + \lambda w(x)f(x) = 0,
	&Af(a) + B\deval{f}{x}{a} = 0, \\
	&Cf(b) + D\deval{f}{x}{b} = 0,
\end{align*}
där $p$, $q$ och $w$ är kontinuerliga reellvärda funktioner, är ett reguljärt Sturm-Liouvilleproblem på $[a, b]$ om $p(a) \neq 0$, $p(b) \neq 0$,  $w(x) > 0$, $(A, B) \neq (0, 0)$ och $(C, D) \neq (0, 0)$.

\subsection{Satser}

\paragraph{Projektion och minsta avstånd}
Låt $e_{1}, \dots, e_{N}$ vara ortonormala basvektorer i inreproduktrummet $V$, och låt
\begin{align*}
	V_{N} = \left\{\sum\limits_{i = 1}^{N}a_{i}e_{i}, i\in\C\right\}.
\end{align*}
Då ges
\begin{align*}
	\inf\limits_{\Phi\in V_{N}}\abs{u - \Phi}
\end{align*}
av
\begin{align*}
	\Phi = \sum\limits_{i = 1}^{N}\inprod{u}{e_{i}}e_{i}.
\end{align*}

\proof

\subparagraph{Följdsats}
De komplexa tal $c_{-N}, \dots, c_{N}$ som minimerar
\begin{align*}
	\norm{u - \sum\limits_{n = -N}^{N}c_{n}e^{inx}}
\end{align*}
är
\begin{align*}
	c_{n} = \inprod{u}{e^{inx}}.
\end{align*}

\proof
Betrakta
\begin{align*}
	\norm{u - \sum\limits_{i = 1}^{N}\gamma_{i}e_{i}}.
\end{align*}
Vi utvecklar inreprodukten och får
\begin{align*}
	\norm{u - \sum\limits_{i = 1}^{N}\gamma_{i}e_{i}} = \norm{u}^{2} - \inprod{u}{\sum\limits_{i = 1}^{N}\gamma_{i}e_{i}} - \cc{\inprod{u}{\sum\limits_{i = 1}^{N}\gamma_{i}e_{i}}} + \norm{\sum\limits_{i = 1}^{N}\gamma_{i}e_{i}}^{2}.
\end{align*}
Vid att skriva $u$ som sin Fourierserie fås
\begin{align*}
	\norm{u - \sum\limits_{i = 1}^{N}\gamma_{i}e_{i}} = \norm{u}^{2} - \sum\limits_{i = 1}^{N}c_{i}\gamma_{i} - \sum\limits_{i = 1}^{N}\cc{c_{i}\gamma_{i}} + \sum\limits_{i = 1}^{N}\abs{\gamma_{i}}^{2}.
\end{align*}
Vid att lägga till och ta bort $\sum\limits_{i = 1}^{N}\abs{c_{i}}^{2}$ fås
\begin{align*}
	\norm{u - \sum\limits_{i = 1}^{N}\gamma_{i}e_{i}} &= \norm{u}^{2} - \sum\limits_{i = 1}^{N}\abs{c_{i}}^{2} + \sum\limits_{i = 1}^{N}\abs{c_{i}}^{2} - \sum\limits_{i = 1}^{N}c_{i}\gamma_{i} - \sum\limits_{i = 1}^{N}\cc{c_{i}\gamma_{i}} + \sum\limits_{i = 1}^{N}\abs{\gamma_{i}}^{2} \\
	                                                 &= \norm{u}^{2} - \sum\limits_{i = 1}^{N}\abs{c_{i}}^{2} + \sum\limits_{i = 1}^{N}\abs{c_{i} - \gamma_{i}}^{2}.
\end{align*}
Vid att välja $c_{i} = \gamma_{i}$ fås det efterfrågade minimumet.

\subparagraph{Mindre följdsats}
\begin{align*}
	\norm{u}^{2} = \sum\limits_{i = 1}^{N}\abs{c_{i}}^{2}.
\end{align*}
%Stämmer detta?

\paragraph{Parsevals sats}
Låt $\{\phi_{i}\}_{i = -\infty}^{\infty}$ vara ett ortonormalt system i $V$ och det för varje $u$ gälla att
\begin{align*}
	\norm{u}^{2} = \sum\limits_{i = -\infty}^{\infty}\abs{\inprod{\phi_{i}}{u}}^{2}.
\end{align*}
Då är $\{\phi_{i}\}_{i = 0}^{N}$ fullständig. Det omvända gäller även.

\proof
Om $\{e_{i}\}_{i = -\infty}^{\infty}$ är ett fullständigt ortonormalt system, kan vi välja $c_{i}$ så att för $N > M$ gäller det att
\begin{align*}
	\norm{u - \sum\limits_{i = -N}^{N}c_{i}\phi_{i}} < \varepsilon.
\end{align*}
Vänstersidan kan med satsen ovan skrivas som
\begin{align*}
	\norm{u - \sum\limits_{i = -N}^{N}c_{i}\phi_{i}}^{2} &= \norm{u}^{2} - \norm{\sum\limits_{i = -n}^{n}c_{i}\phi_{i}}^{2} \\
	                                                    &= \norm{u}^{2} - \norm{\sum\limits_{i = -N}^{N}\inprod{\phi_{i}}{u}\phi_{i}}^{2}.
\end{align*}
Vi får
\begin{align*}
	\norm{u}^{2} - \norm{\sum\limits_{i = -N}^{N}\inprod{\phi_{i}}{u}\phi_{i}}^{2} < \varepsilon,
\end{align*}
och eftersom $\varepsilon$ kan väljas godtyckligt, ger detta
\begin{align*}
	\norm{u}^{2} = \sum\limits_{i = -\infty}^{\infty}\abs{\inprod{\phi_{i}}{u}}^{2}.
\end{align*}

Om vi vidare antar att
\begin{align*}
	\norm{u}^{2} = \sum\limits_{i = -\infty}^{\infty}\abs{\inprod{\phi_{i}}{u}}^{2},
\end{align*}
följer motsatsen från definitionen.

\paragraph{Inreprodukt och ortonormal bas}
Låt $u$ och $v$ vara element i $V$, vars bas är ett fullständigt ortonormalt system $\{\phi_{i}\}_{i = 0}^{N}$. Då gäller att
\begin{align*}
	\inprod{u}{v} = \sum\limits_{i = 0}^{N}\inprod{u}{\phi_{i}}\cc{\inprod{v}{\phi_{i}}}.
\end{align*}

\proof
Med projektionen på $V_{N}$ med bas $\{\phi_{i}\}_{i = -\infty}^{\infty}$ får man
\begin{align*}
	\inprod{\proj{V_{N}}{u}}{\proj{V_{N}}{v}} = 
\end{align*}
%Gör klart

\paragraph{Komplexa exponentialfunktionen och $L^{2}$}
$e^{inx}, n\in\Z$ är ett fullständigt system av ortonormala vektorer i $L^{2}([-\pi, \pi], \C)$.

\proof
Låt $u\in L^{2}([-\pi, \pi], \C)$. Då finns det för alla $\varepsilon > 0$ en styckvist konstant funktion $s$ så att
\begin{align*}
	\norm{u(x) - s(x)} < \frac{1}{3}\varepsilon.
\end{align*}
Vi kan skriva
\begin{align*}
	\norm{u - \sum\limits_{n = -N}^{N}c_{n}e^{inx}}\leq \norm{s - \sum\limits_{n = -N}^{N}c_{n}e^{inx}} + \norm{s - u},
\end{align*}
så beviset är klart om vi kan visa att det finns ett $N$ så att
\begin{align*}
	\norm{s - \sum\limits_{n = -N}^{N}c_{n}e^{inx}} < \frac{2}{3}\varepsilon.
\end{align*}
Vi approximerar $s$ med en kontinuerlig funktion $h$ så att $\norm{s - h} < \frac{1}{3}\varepsilon$. Enligt Fejers sats konvergerar $\conv{F_{N}}{h}$ mot $h$ likformigt. Alltså är
\begin{align*}
	\norm{\conv{F_{N}}{h} - h} < \frac{1}{3}\varepsilon
\end{align*}
för tillräckligt stora $N$. Eftersom $\conv{F_{N}}{h}$ är ett trigonometriskt polynom, kan vi välja det och skriva
\begin{align*}
	\norm{s - \conv{F_{N}}{h}} < \norm{\conv{F_{N}}{h} - h} + \norm{s - h} < \frac{2}{3}\varepsilon,
\end{align*}
och därmed är beviset klart.

\paragraph{Polynomapproximation av funktioner}
Låt $f: [a,b]\to\C$. Då finns det för varje $\varepsilon > 0$ ett polynom $p$ så att
\begin{align*}
	\sup\limits_{[a, b]}\abs{f(x) - p(x)} < \varepsilon.
\end{align*}

\proof
Gör en Taylorapproximation av Fourierserien till $f$. Detta ger
\begin{align*}
	\abs{f(x) - p(x)} \leq \abs{f(x) - \sum\limits_{n = -N}^{N}c_{n}e^{inx}} + \abs{\sum\limits_{n = -N}^{N}c_{n}e^{inx} - p(x)} < \varepsilon. 
\end{align*}

\paragraph{Legendrepolynomens fullständighet}
Legendrepolynomen är ett fullständigt system i $L^{2}([-1, 1], \C)$.

\proof
Ideen är att det finns ett polynom $p$ av grad $n$ så att en funktion $f$ kan approximeras godtyckligt väl av detta polynomet i norm-mening. Detta ger
\begin{align*}
	\norm{f - p}^{2} = \inteval{-1}{1}{\abs{f(x) - p(x)}^{2}}{x} \leq 2\varepsilon^{2}.
\end{align*}
Det räcker därmed att visa att alla polynom kan skrivas som en linjärkombination av Legendrepolynom. Detta stämmer eftersom man kan hitta $n + 1$ linjärt oberoende Legendrepolynom.

\paragraph{Jämna och udda Legendrepolynom}
$p_{n}$ är jämn om $n$ är jämn och udda om $n$ är udda.

\proof
Följer från Gram-Schmidt.

\paragraph{Rodrigues' formel}
\begin{align*}
	p_{n}(x) = \frac{1}{2^{n}n!}\dv[n]{(x^{2} - 1) ^{n}}{x}.
\end{align*}

\proof

\paragraph{Sturm-Liouvilleoperatorns symmetri}
Operatorn
\begin{align*}
	L = \dv{x}\left(p(x)\dv{x}\right) + q(x) + \lambda w(x)
\end{align*}
med inreprodukten
\begin{align*}
	\inprod{f}{g} = \inteval{a}{b}{f(x)\cc{g}(x)w(x)}{x}
\end{align*}
på $C^{2}([a, b])$ har en icke-trivial kärna om det finns $(A, B) \neq (0, 0)$ och $(C, D) \neq (0, 0)$ så att
\begin{align*}
	Af(a) + B\deval{f}{x}{a} = 0, \\
	Cf(b) + D\deval{f}{x}{b} = 0, \\
	A\cc{g}(a) + B\deval{\cc{g}}{x}{a} = 0, \\
	C\cc{g}(b) + D\deval{\cc{g}}{x}{b} = 0.
\end{align*}

\proof
Vi betraktar i stället operatorn
\begin{align*}
	A = \frac{1}{w(x)}\left(\dv{x}\left(p(x)\dv{x}\right) + q(x)\right).
\end{align*}
Om denna är symmetrisk, har vi visat satsen. Vi får
\begin{align*}
	\inprod{Af}{g} &= \inteval{a}{b}{\frac{1}{w(x)}\left(\dv{x}\left(p(x)\deval{f}{x}{x}\right) + q(x)f(x)\right)\cc{g}(x)w(x)}{x} \\
	               &= \inteval{a}{b}{\dv{x}\left(p(x)\deval{f}{x}{x}\right)\cc{g}(x)}{x} + \inteval{a}{b}{q(x)f(x)\cc{g}(x)}{x} \\
	               &= \left[p(x)\deval{f}{x}{x}\cc{g}(x)\right]_{a}^{b} - \inteval{a}{b}{p(x)\deval{f}{x}{x}\deval{\cc{g}}{x}{x}}{x} + \inteval{a}{b}{q(x)f(x)\cc{g}(x)}{x}.
\end{align*}
Vi jämför detta med
\begin{align*}
	\inprod{f}{Ag}&= \inteval{a}{b}{f(x)\cc{\left(\frac{1}{w(x)}\dv{x}\left(p(x)\deval{\cc{g}}{x}{x}\right) + q(x)\cc{g}(x)\right)}w(x)}{x} \\
	               &= \inteval{a}{b}{f(x)\dv{x}\left(p(x)\deval{\cc{g}}{x}{x}\right)}{x} + \inteval{a}{b}{q(x)f(x)\cc{g}(x)}{x} \\
	               &= \left[p(x)f(x)\deval{\cc{g}}{x}{x}\right]_{a}^{b} - \inteval{a}{b}{p(x)\deval{f}{x}{x}\deval{\cc{g}}{x}{x}}{x} + \inteval{a}{b}{q(x)f(x)\cc{g}(x)}{x},
\end{align*}
där vi har utnyttjat att $p$, $q$ och $w$ är reellvärda. Detta ger
\begin{align*}
	\inprod{Af}{g} - \inprod{f}{Ag} = \left[p(x)\deval{f}{x}{x}\cc{g}(x)\right]_{a}^{b} - \left[p(x)f(x)\deval{\cc{g}}{x}{x}\right]_{a}^{b}.
\end{align*}
Detta ger att $A$ är symmetrisk om det finns $(A, B) \neq (0, 0)$ och $(C, D) \neq (0, 0)$ så att
\begin{align*}
	Af(a) + B\deval{f}{x}{a} = 0, \\
	Cf(b) + D\deval{f}{x}{b} = 0, \\
	A\cc{g}(a) + B\deval{\cc{g}}{x}{a} = 0, \\
	C\cc{g}(b) + D\deval{\cc{g}}{x}{b} = 0.
\end{align*}
Inreprodukten över kan även skrivas som
\begin{align*}
	\inprod{Af}{g} - \inprod{f}{Ag} &= p(b)\deval{f}{x}{b}\cc{g}(b) - p(a)\deval{f}{x}{a}\cc{g}(a) - p(b)f(b)\deval{\cc{g}}{x}{b} + p(a)f(a)\deval{\cc{g}}{x}{a} \\
	                                &= p(b)
	                                \mqty[
	                                	f(b) \\
	                                	\deval{f}{x}{b})
	                                ]
	                                \cdot
	                                \mqty[
	                                	-\deval{\cc{g}}{x}{b} \\
	                                	\cc{g}(b)
	                                ]
	                                - p(a)
	                                \mqty[
	                                	f(a) \\
	                                	\deval{f}{x}{a})
	                                ]
	                                \cdot
	                                \mqty[
	                                	-\deval{\cc{g}}{x}{a} \\
	                                	\cc{g}(a)
	                                ]
\end{align*}

\paragraph{•}
Låt $D_{L}$ vara alla $C^{2}$-funktioner på $[a, b]$ så att
\begin{align*}
	Af(a) + B\deval{f}{x}{a} = 0, \\
	Cf(b) + D\deval{f}{x}{b} = 0.
\end{align*}
Då är Sturm-Liouville-operatorn symmetrisk om $(A, B) \neq (0, 0)$ och $(C, D) \neq (0, 0)$.

\paragraph{Sturm-Liouvilles sats}
Sturm-Liouville-operatorn har oändligt många reella egenvärden.

Om $\phi_{n}$ är en egenfunktion som motsvarar $\lambda_{n}$ är $\phi_{n}$ unik och $\{\phi_{n}\}$ är en fullständig ortogonal mängd i $L^{2}([a, b], \C)$.

\proof
Vi visar inte fullständighet.

För att visa att egenvärdena är reella, låter vi $L\phi_{n} = \lambda{n}\phi_{n}$. Detta ger
\begin{align*}
	\lambda_{n}\inprod{\phi_{n}}{\phi_{n}} = \inprod{L\phi_{n}}{\phi_{n}} = \inprod{\phi_{n}}{L\phi_{n}} = \inprod{\phi_{n}}{\lambda_{n}\phi_{n}} = \cc{\lambda_{n}}\inprod{\phi_{n}}{\phi_{n}},
\end{align*}
och beviset är klart.

För att visa ortogonaliteten, låt $\lambda_{n} \neq \lambda_{m}$. Detta ger
\begin{align*}
	\lambda_{n}\inprod{\phi_{n}}{\phi_{m}} = \inprod{L\phi_{n}}{\phi_{m}} = \inprod{\phi_{n}}{L\phi_{m}} = \inprod{\phi_{n}}{\lambda_{m}\phi_{m}} = \cc{\lambda_{m}}\inprod{\phi_{n}}{\phi_{m}}.
\end{align*}
Om egenvektorerna inte är ortogonala, måste egenvärdena vara lika. Eftersom detta strider mot antagandet, måste egenvektorerna vara ortogonala.

\paragraph{Följdsats}
Reguljära Sturm-Liouvilleproblem har en lösning. Om
\begin{align*}
	g(x) = \dv{x}\left(p(x)\deval{f}{x}{x}\right) + q(x)f(x),
\end{align*}
ges lösningen av
\begin{align*}
	f(x) = \sum\limits_{i = 1}^{\infty}\frac{\inprod{\phi_{n}}{g}}{\inprod{\phi_{n}}{\phi_{n}}}\frac{1}{\lambda_{n}}\phi_{n}.
\end{align*}

\proof
Följer vid att låta
\begin{align*}
	\dv{x}\left(p(x)\dv{x}\right) + q(x)
\end{align*}
verka på $f$.
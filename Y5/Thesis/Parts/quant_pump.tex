\section{Quantum Pumps}

\paragraph{Quantum Phases}
Quantum phases are low-temperature phases of matter. For parametrized system, the existence of quantum fluctuations entails that these systems exhibit phase transitions, realized by varying parameters of the Hamiltonian. The phase transition describes an abrupt change in the ground state.

\paragraph{Berry Phase, Connection and Curvature}
Consider a system with a Hamiltonian and eigenstates parametrized by some set of parameters $\chi$ - that is, we have for each value of $\chi$ a set of eigenstates
\begin{align*}
	\ham(\chi)\ket{n(\chi)} = E_{n}(\chi)\ket{n(\chi)}.
\end{align*}
The adiabatic theorem tells us that if $R$ is varied such that the Hamiltonian changes sufficiently slowly, a state which is initialized to an eigenstate at $t = 0$ will evolve to a corresponding eigenstate at a later time. In the general case we have
\begin{align*}
	\ket{\psi_{n}(t)} = e^{i\gamma_{n}(t)}e^{-\frac{i}{\hbar}\inte{0}{t}\dd{\tau} E_{n}(\tau)}\ket{n(\chi(t))}.
\end{align*}
The former factor is the complex exponential of the so-called Berry phase. Inserting this into the SchrÃ¶dinger equation we find
\begin{align*}
	\gamma_{n} = i\inte{0}{t}\dd{\tau}\expval{\pdv{\tau}}{n(\chi(\tau))}.
\end{align*}
Noting that
\begin{align*}
	\pdv{\tau}\ket{n(\chi(\tau))} =& \dv{R}{\tau}\cdot\grad_{R}\ket{\chi(R)},
\end{align*}
we can define the Berry connection
\begin{align*}
	A_{n} = i\expval{\grad_{\chi}}{n(\chi)}
\end{align*}
and find
\begin{align*}
	\gamma_{n} = i\inte{C}{}\dd{\chi}\cdot A_{n}.
\end{align*}
$C$ is the orbit in parameter space traversed during the time evolution.

In a slightly more sophisticated manner, the Berry connection may be taken to be a 1-form
\begin{align*}
	A_{n} = i\bra{n(R)}\del{}{\mu}{\ket{n(R)}}\df{\chi^{\mu}}.
\end{align*}
Due to Stokes' theorem, the line integral of the Berry connection about some closed path is related to the surface integral of its exterior derivative, termed the Berry curvature. Its components are
\begin{align*}
	\Omega^{(2)}_{n, \mu\nu} = \del{}{\mu}A_{n, \nu} - \del{}{\nu}A_{n, \mu},
\end{align*}
and we have
\begin{align*}
	\inte{\bound{S}}{}A_{n} = \frac{1}{2}\inte{S}{}\dd{\chi^{\mu}}\wedge\dd{\chi^{\nu}}\Omega^{(2)}_{n, \mu\nu}.
\end{align*}

\paragraph{A More Sophisticated Definition}
From this point on we switch to the more compact notation
\begin{align*}
	\del{}{\mu}\ket{n} = \ket{\del{}{\mu}n}
\end{align*}
and suppress the parameter dependence. The Berry curvature is given by
\begin{align*}
	\Omega^{(2)} = \df{A_{n}} = \frac{1}{2}(\del{}{\mu}A_{n, \nu} - \del{}{\nu}A_{n, \mu})\df{\chi^{\mu}}\wedge\df{\chi^{\nu}},
\end{align*}
and we find
\begin{align*}
	\Omega^{(2)}_{\mu\nu} = i\left(\braket{\del{}{\mu}n}{\del{}{\nu}n} + \braket{n}{\del{}{\mu}\del{}{\nu}n} - \braket{\del{}{\nu}n}{\del{}{\mu}n} - \braket{n}{\del{}{\nu}\del{}{\mu}n}\right) = i\left(\braket{\del{}{\mu}n}{\del{}{\nu}n} - \braket{\del{}{\nu}n}{\del{}{\mu}n}\right).
\end{align*}
This can be expressed without derivatives of the state. To do that we differentiate the eigenvalue expression to yield
\begin{align*}
	\del{}{\mu}\ham\ket{n} + \ham\ket{\del{}{\mu}n} = \del{}{\mu}E_{n}\ket{n} + E_{n}\ket{\del{}{\mu}n}.
\end{align*}
Using the orthogonality of the eigenstates, we have for some $n\neq m$ that
\begin{align*}
	\mel{m}{\del{}{\mu}\ham}{n} = (E_{n} - E_{m})\braket{m}{\del{}{\mu}n}.
\end{align*}
We can now solve for the inner product on the left-hand side and its complex conjugate, as well as sum over $m$, to find
\begin{align*}
	\Omega^{(2)}_{\mu\nu} = i\sum\limits_{m\neq n}\frac{\mel{n}{\del{}{\mu}\ham}{m}\mel{m}{\del{}{\nu}\ham}{n} - \text{c.c}}{(E_{n} - E_{m})^{2}}.
\end{align*}

Finally we introduce a third definition
\begin{align*}
	\Omega^{(2)} = \frac{i}{2}\oint\frac{\dd{z}}{2\pi i}\tr(G\df{\ham}G^{2}\df{\ham}).
\end{align*}
$G$ is given by $(z - \ham)^{-1}$ and the integral is a counter-clockwise contour integral around the energy of the state in consideration. There is also the appearance of the exterior derivative of the Hamiltonian.

Does this correspond to our previous notion of the Berry curvature? To investigate, let us rewrite the above operators as
\begin{align*}
	\ham = \sum\limits_{n}E_{n}\op{n},\ G = \sum\limits_{n}\frac{1}{z - E_{n}}\op{n}.
\end{align*}
Next we note that
\begin{align*}
	G\df{G^{-1}} = -\df{G}G^{-1} = -G\df{\ham},
\end{align*}
hence
\begin{align*}
	G\df{G^{-1}}G\df{G^{-1}}G = G\df{\ham}G\df{\ham}G,
\end{align*}
and by cyclic permutation we have
\begin{align*}
	\tr(G\df{G^{-1}}G\df{G^{-1}}G) =& \tr(G\df{\ham}G\df{\ham}G) \\
	=& \tr(G\del{}{\mu}\ham G\del{}{\nu}\ham G)\df{\chi^{\mu}}\df{\chi^{\nu}} \\
	=& \tr(G\del{}{\nu}\ham G^{2}\del{}{\mu}\ham)\df{\chi^{\mu}}\df{\chi^{\nu}} \\
	=& -\tr(G\df{\ham}G^{2}\df{\ham}).
\end{align*}

As a warmup to the final computation, consider a case where the spectrum is parameter-independent.  In the eigenbasis of the Hamiltonian we generally have
\begin{align*}
	\df{G^{-1}} =& \sum\limits_{n}\left(-\del{}{\mu}E_{n}\op{n} + (z - E_{n})\left(\op{\del{}{\mu}n}{n} + \op{n}{\del{}{\mu}n}\right)\right)\df{\chi^{\mu}}, \\
	\df{G}      =& \sum\limits_{n}\left(\frac{\del{}{\mu}E_{n}}{(z - E_{n})^{2}}\op{n} + \frac{1}{z - E_{n}}\left(\op{\del{}{\mu}n}{n} + \op{n}{\del{}{\mu}n}\right)\right)\df{\chi^{\mu}},
\end{align*}
and thus in this case
\begin{align*}
	G\df{G^{-1}}G\df{G^{-1}}G =& \sum\frac{(z - E_{2})(z - E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\op{1}\left(\op{\del{}{\mu}2}{2} + \op{2}{\del{}{\mu}2}\right)\op{3}\left(\op{\del{}{\nu}4}{4} + \op{4}{\del{}{\nu}4}\right)\op{5}e^{\mu\nu},
\end{align*}
where the natural numbers are summed over and we abbreviate the differential form basis vector. Multiplying this out we have
\begin{align*}
	G\df{G^{-1}}G\df{G^{-1}}G = \sum&\frac{(z - E_{2})(z - E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\ket{1}\left(\braket{1}{\del{}{\mu}2}\kdelta{}{23} + \kdelta{}{12}\braket{\del{}{\mu}2}{3}\right)\left(\braket{3}{\del{}{\nu}4}\kdelta{}{45} + \kdelta{}{34}\braket{\del{}{\nu}4}{5}\right)\bra{5}e^{\mu\nu} \\
	= \sum&\ket{1}\left(\frac{(z - E_{2})(z - E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\braket{1}{\del{}{\mu}2}\kdelta{}{23}\braket{3}{\del{}{\nu}4}\kdelta{}{45} \right. \\
	&+ \left. \frac{(z - E_{2})(z - E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\braket{1}{\del{}{\mu}2}\kdelta{}{23}\kdelta{}{34}\braket{\del{}{\nu}4}{5} \right. \\
	&+ \left. \frac{(z - E_{2})(z - E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\kdelta{}{12}\braket{\del{}{\mu}2}{3}\braket{3}{\del{}{\nu}4}\kdelta{}{45} \right. \\
	&+ \left. \frac{(z - E_{2})(z - E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\kdelta{}{12}\braket{\del{}{\mu}2}{3}\kdelta{}{34}\braket{\del{}{\nu}4}{5}\right)\bra{5}e^{\mu\nu} \\
	= \sum&\ket{1}\left(\frac{1}{z - E_{1}}\braket{1}{\del{}{\mu}2}\braket{2}{\del{}{\nu}4}\bra{4} + \frac{z - E_{2}}{(z - E_{1})(z - E_{5})}\braket{1}{\del{}{\mu}2}\braket{\del{}{\nu}2}{5}\bra{5} \right. \\
	&+ \left. \frac{1}{z - E_{3}}\braket{\del{}{\mu}1}{3}\braket{3}{\del{}{\nu}4}\bra{4} + \frac{1}{z - E_{5}}\braket{\del{}{\mu}1}{3}\braket{\del{}{\nu}3}{5}\bra{5}\right)e^{\mu\nu},
\end{align*}
and
\begin{align*}
	\tr(G\df{G^{-1}}G\df{G^{-1}}G) =& \sum\left(\frac{1}{z - E_{1}}\braket{1}{\del{}{\mu}2}\braket{2}{\del{}{\nu}4}\braket{4}{1} + \frac{z - E_{2}}{(z - E_{1})(z - E_{5})}\braket{1}{\del{}{\mu}2}\braket{\del{}{\nu}2}{5}\braket{5}{1} \right. \\
	&+ \left. \frac{1}{z - E_{3}}\braket{\del{}{\mu}1}{3}\braket{3}{\del{}{\nu}4}\braket{4}{1} + \frac{1}{z - E_{5}}\braket{\del{}{\mu}1}{3}\braket{\del{}{\nu}3}{5}\braket{5}{1}\right)e^{\mu\nu} \\
	1=& \sum\left(\frac{1}{z - E_{1}}\braket{1}{\del{}{\mu}2}\braket{2}{\del{}{\nu}4}\kdelta{}{41} + \frac{z - E_{2}}{(z - E_{1})(z - E_{5})}\braket{1}{\del{}{\mu}2}\braket{\del{}{\nu}2}{5}\kdelta{}{51} \right. \\
	&+ \left. \frac{1}{z - E_{3}}\braket{\del{}{\mu}1}{3}\braket{3}{\del{}{\nu}4}\kdelta{}{41} + \frac{1}{z - E_{5}}\braket{\del{}{\mu}1}{3}\braket{\del{}{\nu}3}{5}\kdelta{}{51}\right)e^{\mu\nu} \\
	=& \sum\left(\frac{1}{z - E_{1}}\braket{1}{\del{}{\mu}2}\braket{2}{\del{}{\nu}1} + \frac{z - E_{2}}{(z - E_{1})^{2}}\braket{1}{\del{}{\mu}2}\braket{\del{}{\nu}2}{1} \right. \\
	&+ \left. \frac{1}{z - E_{3}}\braket{\del{}{\mu}1}{3}\braket{3}{\del{}{\nu}1} + \frac{1}{z - E_{1}}\braket{\del{}{\mu}1}{3}\braket{\del{}{\nu}3}{1}\right)e^{\mu\nu}.
\end{align*}
Let us now perform the contour integral about a particular energy $E_{n}$. All of them are equal to 1 if and only if $n$ is equal to the index that appears in the denominator, hence
\begin{align*}
	\Omega^{(2)} =& -\frac{i}{2}\sum\left(\braket{n}{\del{}{\mu}1}\braket{1}{\del{}{\nu}n} + \braket{n}{\del{}{\mu}1}\braket{\del{}{\nu}1}{n} + \braket{\del{}{\mu}1}{n}\braket{n}{\del{}{\nu}1} + \braket{\del{}{\mu}n}{1}\braket{\del{}{\nu}1}{n}\right)e^{\mu\nu} \\
	=& -\frac{i}{2}\sum\left(-\braket{\del{}{\mu}n}{1}\braket{1}{\del{}{\nu}n} + \braket{\del{}{\mu}n}{1}\braket{1}{\del{}{\nu}n} + \braket{1}{\del{}{\mu}n}\braket{\del{}{\nu}n}{1} - \braket{\del{}{\mu}n}{1}\braket{1}{\del{}{\nu}n}\right)e^{\mu\nu} \\
	=& \frac{i}{2}\left(\braket{\del{}{\mu}n}{\del{}{\nu}n} - \braket{\del{}{\nu}n}{\del{}{\mu}n}\right)e^{\mu\nu},
\end{align*}
and thus
\begin{align*}
	\Omega^{(2)}_{\mu\nu} = i\left(\braket{\del{}{\mu}n}{\del{}{\nu}n} - \braket{\del{}{\nu}n}{\del{}{\mu}n}\right).
\end{align*}

Let us now go to the general case. It will contain an operator product
\begin{align*}
	 &\op{1}\left(-\del{}{\mu}E_{2}\op{2} + (z - E_{2})\left(\op{\del{}{\mu}2}{2} + \op{2}{\del{}{\mu}2}\right)\right)\op{3}\left(-\del{}{\nu}E_{4}\op{4} + (z - E_{4})\left(\op{\del{}{\nu}4}{4} + \op{4}{\del{}{\nu}4}\right)\right)\op{5} \\
	=& \ket{1}\left(-\del{}{\mu}E_{2}\kdelta{}{12}\kdelta{}{23} + (z - E_{2})\left(\braket{1}{\del{}{\mu}2}\kdelta{}{23} + \kdelta{}{12}\braket{\del{}{\mu}2}{3}\right)\right)\left(-\del{}{\nu}E_{4}\kdelta{}{34}\kdelta{}{45} + (z - E_{4})\left(\braket{3}{\del{}{\nu}4}\kdelta{}{45} + \kdelta{}{34}\braket{\del{}{\nu}4}{5}\right)\right)\bra{5},
\end{align*}
and the trace will turn this to
\begin{align*}
	\left(-\del{}{\mu}E_{2}\kdelta{}{12}\kdelta{}{23} + (z - E_{2})\left(\braket{1}{\del{}{\mu}2}\kdelta{}{23} + \kdelta{}{12}\braket{\del{}{\mu}2}{3}\right)\right)\left(-\del{}{\nu}E_{4}\kdelta{}{34}\kdelta{}{45} + (z - E_{4})\left(\braket{3}{\del{}{\nu}4}\kdelta{}{45} + \kdelta{}{34}\braket{\del{}{\nu}4}{5}\right)\right)\kdelta{}{15}.
\end{align*}
Each bracket has three terms, so let us denote their products (after adding the extra factors) as $a_{ij}$, with $i$ and $j$ denoting which terms from each of the brackets are multiplied. We know that when tracing $a_{22} + a_{23} + a_{32} + a_{33}$, we get the result. We will thus have completed the proof if we can show that the others yield no net contribution. First we have
\begin{align*}
	\sum a_{11} =& \sum\frac{1}{(z - E_{1})(z - E_{3})(z - E_{5})}\left(-\del{}{\mu}E_{2}\kdelta{}{12}\kdelta{}{23}\right)\left(-\del{}{\nu}E_{4}\kdelta{}{34}\kdelta{}{45}\right)\kdelta{}{15}e^{\mu\nu} \\
	            =& \sum\frac{\del{}{\mu}(E_{2})\del{}{\nu}(E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\kdelta{}{12}\kdelta{}{23}\kdelta{}{34}\kdelta{}{45}\kdelta{}{15}e^{\mu\nu} \\
	            =& \sum\frac{\del{}{\mu}(E_{1})\del{}{\nu}(E_{1})}{(z - E_{1})^{3}}e^{\mu\nu}.
\end{align*}
This is identically zero as it contains a contraction of symmetric components with the antisymmetric differential form basis. As for the others we have
\begin{align*}
	\sum a_{12} =& -\sum\frac{\del{}{\mu}E_{2}(z - E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\kdelta{}{12}\kdelta{}{23}\braket{3}{\del{}{\nu}4}\kdelta{}{45}\kdelta{}{15}e^{\mu\nu} = -\sum\frac{\del{}{\mu}E_{1}}{(z - E_{1})^{2}}\braket{1}{\del{}{\nu}1}e^{\mu\nu}, \\
	\sum a_{13} =& -\sum\frac{\del{}{\mu}E_{2}(z - E_{4})}{(z - E_{1})(z - E_{3})(z - E_{5})}\kdelta{}{12}\kdelta{}{23}\kdelta{}{34}\braket{\del{}{\nu}4}{5}\kdelta{}{15}e^{\mu\nu} = -\sum\frac{\del{}{\mu}E_{1}}{(z - E_{1})^{2}}\braket{\del{}{\nu}1}{1}e^{\mu\nu}, \\
	\sum a_{21} =& -\sum\frac{\del{}{\nu}E_{4}(z - E_{2})}{(z - E_{1})(z - E_{3})(z - E_{5})}\braket{1}{\del{}{\mu}2}\kdelta{}{23}\kdelta{}{34}\kdelta{}{45}\kdelta{}{15}e^{\mu\nu} = -\sum\frac{\del{}{\nu}E_{1}}{(z - E_{1})^{2}}\braket{1}{\del{}{\mu}1}e^{\mu\nu}, \\
	\sum a_{31} =& -\sum\frac{\del{}{\nu}E_{4}(z - E_{2})}{(z - E_{1})(z - E_{3})(z - E_{5})}\kdelta{}{12}\braket{\del{}{\mu}2}{3}\kdelta{}{34}\kdelta{}{45}\kdelta{}{15}e^{\mu\nu} = -\sum\frac{\del{}{\nu}E_{1}}{(z - E_{1})^{2}}\braket{\del{}{\mu}1}{1}e^{\mu\nu},
\end{align*}
and these all cancel each other exactly, completing the proof.

\paragraph{Properties of Parametrized States}
We will now derive some useful properties of derivatives of states of parametrized systems. Because orthogonality is preserved we have
\begin{align*}
	\del{}{\mu}\braket{m}{n} = \braket{\del{}{\mu}m}{n} + \braket{m}{\del{}{\mu}n} = 0.
\end{align*}
Because the identity is also preserved we have
\begin{align*}
	\sum\op{\del{}{\mu}n}{n} + \op{n}{\del{}{\mu}n} = 0.
\end{align*}

\paragraph{Applications of the Above}
What is the use of the Berry connection and curvature? From the point of view of computing responses in quantum systems, the answer might seem to be not much. More broadly, however, it turns out that the Berry curvature in particular is useful in characterizing systems. The idea is as follows: An important assumption of the above arguments is the existence of a non-degenerate and gapped ground state for all parameter values. If the integral $\Omega^{(2)}$ over some closed surface is zero, it follows by Stokes' theorem that there are no degeneracy points enclosed by the surface, as $\Omega^{(2)}$ is closed everywhere. As such, the Berry curvature can be used to detect degeneracy points. It also turns out that the degeneracy points are stable under deformations of the Hamiltonian, as integrals of the Berry curvature are quantized.

\paragraph{The Single Spin - an Example}
Consider a single spin-$\frac{1}{2}$ in an external field. The Hamiltonian is
\begin{align*}
	\ham = h_{x}\sigma_{x} + h_{y}\sigma_{y} + h_{z}\sigma_{z}.
\end{align*}
With respect to the $\sigma_{z}$ eigenstates at $\theta = \phi = 0$, which are of course angle-independent, we have
\begin{align}
	\ket{\downarrow}_{\theta, \phi} = \mqty[
		-\sin(\frac{\theta}{2})e^{-i\phi} \\
		\cos(\frac{\theta}{2})
	],\ \ket{\uparrow}_{\theta, \phi} = \mqty[
		\cos(\frac{\theta}{2})e^{-i\phi} \\
		\sin(\frac{\theta}{2})
	],
	\label{eq:spin_angle_states}
\end{align}
and thus
\begin{align*}
	A_{-, \theta} = 0,\ A_{-, \phi} = \sin[2](\frac{\theta}{2}),\ A_{+, \theta} = 0,\ A_{+, \phi} = \cos[2](\frac{\theta}{2}).
\end{align*}
The Berry curvature is then
\begin{align*}
	\Omega^{(2)}_{\pm, \theta\phi} = \mp\frac{1}{2}\sin(\theta).
\end{align*}
This implies that the Berry phase induced after an adiabatic cycle is equal to half the subtended solid angle.

This example is brought up time after time in this context, but rarely elaborated upon. It was the first example considered in the field, as Berry used it in his first paper describing the Berry phase, lending it some credibility, but the addition of the Berry curvature, and in particular its integral over all of $S^{2}$, is a later invention. Its significance is never stated, but still high, as the Berry curvature is, in a sense, produced by the degeneracy point at the origin. This shows both the value of the Berry curvature as a way to probe unknown parts of the phase diagram of a system and its use for creating topological invariants to classify systems.

\paragraph{The Quantum Hall Effect}
Consider a two-dimensional electron gas in an external electromagnetic field. If the magnetic field is constant, there exists a generalized translation operator which commutes with the Hamiltonian, and we can thus introduce Bloch functions according to
\begin{align*}
	\psi_{n, \vb{k}} = e^{i\vb{k}\cdot\vb{r}}u_{n, \vb{k}}(\vb{r}).
\end{align*}
These are eigenfunctions of the Hamiltonian
\begin{align*}
	H = \frac{1}{2m}\left(\vb{p} + \hbar\vb{k} + \vb{A}(\vb{r})\right)^{2} + V(\vb{r}),
\end{align*}
with energies $E_{n}(\vb{k})$. The current carried in this system is proportional to the expectation value
\begin{align*}
	\frac{1}{m}\expval{\vb{v}}{\psi_{n, \vb{k}}} = \frac{1}{\hbar}\expval{\grad_{\vb{k}}H}{u_{n, \vb{k}}}.
\end{align*}
Let us study this by bringing it into the framework of parametrized systems. More specifically, let us study the expectation values of generalized velocity operators
\begin{align*}
	V_{\mu} = \del{}{\mu}\ham.
\end{align*}
To that end, we consider states $\ket{\phi_{n}}$ that remain close to, but not identical to, the instantaneous eigenstate $\ket{n}$, and write it as
\begin{align*}
	\ket{\phi_{n}(t)} = e^{-i\inte{0}{t}\dd{\tau}E_{n}(\tau)}\ket{\tilde{\phi}_{n}}.
\end{align*}
We then find
\begin{align*}
	\ham\ket{\phi_{n}} =& e^{-i\inte{0}{t}\dd{\tau} E_{n}(\tau)}\ham\ket{\tilde{\phi}_{n}} \\
	=& e^{-i\inte{0}{t}\dd{\tau} E_{n}(\tau)}\left(E_{n} + i\del{}{t}\right)\ket{\tilde{\phi}_{n}},
\end{align*}
and thus
\begin{align*}
	\del{}{\mu}\ham\ket{\tilde{\phi}_{n}} =& \del{}{\mu}\left(E_{n} + i\del{}{t}\right)\ket{\tilde{\phi}_{n}} + \left(E_{n} - \ham\right)\del{}{\mu}\ket{\tilde{\phi}_{n}}.
\end{align*}
Because the Hamiltonian contains no time derivatives, it may equally well be computed with $\ket{\phi_{n}(t)}$ and $\ket{\tilde{\phi}_{n}}$, and we then have
\begin{align*}
	\expval{V_{\mu}}_{n} =& \del{}{\mu}E_{n} + \mel{\tilde{\phi}_{n}}{i\del{}{\mu}\del{}{t}}{\tilde{\phi}_{n}} + \mel{\tilde{\phi}_{n}}{\left(E_{n} - \ham\right)\del{}{\mu}}{\tilde{\phi}_{n}} \\
	                     =& \del{}{\mu}E_{n} + i\left(\mel{\tilde{\phi}_{n}}{\del{}{\mu}\del{}{t}}{\tilde{\phi}_{n}} + \del{}{t}\left(\bra{\tilde{\phi}_{n}}\right)\del{}{\mu}\ket{\tilde{\phi}_{n}}\right).
\end{align*}
The first term will correspond to the usual Bloch drift velocity, and the remaining terms are corrections due to the parametrized nature of the system. To work the corrections out, we use the fact that
\begin{align*}
	\mel{\tilde{\phi}_{n}}{i\del{}{t}}{\tilde{\phi}_{n}} = \mel{\tilde{\phi}_{n}}{(\ham - E_{n})}{\tilde{\phi}_{n}}
\end{align*}
is negligible in the adiabatic limit, yielding
\begin{align*}
	\expval{V_{\mu}}_{n} =& \del{}{\mu}E_{n} + i\left(\del{}{t}\left(\bra{\tilde{\phi}_{n}}\right)\del{}{\mu}\ket{\tilde{\phi}_{n}} - \del{}{\mu}\left(\bra{\tilde{\phi}_{n}}\right)\del{}{t}\ket{\tilde{\phi}_{n}}\right).
\end{align*}
Furthermore, as the time dependence only manifests through the time-dependent parameters, one can expand the time derivative and obtain in the adiabatic limit
\begin{align*}
	\expval{V_{\mu}}_{n} =& \del{}{\mu}E_{n} + i\dv{R^{\nu}}{t}\left(\del{}{\nu}\left(\bra{\tilde{\phi}_{n}}\right)\del{}{\mu}\ket{\tilde{\phi}_{n}} - \del{}{\mu}\left(\bra{\tilde{\phi}_{n}}\right)\del{}{\nu}\ket{\tilde{\phi}_{n}}\right) \\
	=& \del{}{\mu}E_{n} - \Omega^{(2)}_{\mu\nu}\dv{R^{\nu}}{t}.
\end{align*}
In particular, for Bloch electrons we have $\dv{\vb{k}}{t} = -e\vb{E}$, and the total correction to the conductivity is
\begin{align*}
	\vb{J} \propto \vb{E}\times\inte{}{}\vb*{\Omega}^{(2)}.
\end{align*}
This is a Hall-style contribution, and the quantization of the total Berry curvature produces the integer quantum Hall effect.

\paragraph{Higher Berry Curvature and the KS Invariant}
For an infinite $1d$ system, $\Omega^{(2)}$ might diverge. A convergent quantity might instead be found by splitting the Hamiltonian into a sum of local terms working at a finite range, i.e.
\begin{align*}
	\ham = \sum\limits_{p\in\mathbb{Z}}\ham_{p}.
\end{align*}
The quantity
\begin{align*}
	F^{(2)}_{pq} = \frac{i}{2}\oint\frac{\dd{z}}{2\pi i}\tr(G\df{\ham_{p}}G^{2}\df{\ham_{q}})
\end{align*}
then decays exponentially with respect to $\abs{p - q}$ if the Hamiltonian is gapped, and is thus well-defined. Next we can construct the two-form
\begin{align*}
	F^{(2)}_{q} = \sum\limits_{p\in\mathbb{Z}}F^{(2)}_{pq} = \frac{i}{2}\oint\frac{\dd{z}}{2\pi i}\tr(G\df{\ham}G^{2}\df{\ham_{q}}).
\end{align*}
Its exterior derivative is given by
\begin{align*}
	\df{F^{(2)}_{q}} = \sum\limits_{p\in\mathbb{Z}}F^{(3)}_{pq}.
\end{align*}
We have
\begin{align*}
	 &\del{}{\rho}(G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q})e^{\rho\mu\nu} \\
	=& \left(\del{}{\rho}G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q} + G\del{}{\rho}\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}\del{}{\rho}G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}G^{2}\del{}{\rho}\del{}{\nu}\ham_{q}\right)e^{\rho\mu\nu} \\
	=& \left(\del{}{\rho}G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}(\del{}{\rho}GG + G\del{}{\rho}G)\del{}{\nu}\ham_{q}\right)e^{\rho\mu\nu} \\
	=& \left(\del{}{\rho}\ham G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}(G\del{}{\rho}\ham G^{2} + G^{2}\del{}{\rho}\ham G)\del{}{\nu}\ham_{q}\right)e^{\rho\mu\nu} \\
	=& \left(\del{}{\rho}\ham G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}(G\del{}{\rho}\ham G^{2} + G^{2}\del{}{\rho}\ham G)\del{}{\nu}\ham_{q}\right)e^{\rho\mu\nu} \\
	=& \left(\del{}{\rho}\ham G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}G\del{}{\rho}\ham G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}G^{2}\del{}{\rho}\ham G\del{}{\nu}\ham_{q}\right)e^{\rho\mu\nu},
\end{align*}
and thus
\begin{align*}
	 &\tr(\del{}{\rho}(G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q}))e^{\rho\mu\nu} \\
	=& \tr(\del{}{\rho}\ham G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}G\del{}{\rho}\ham G^{2}\del{}{\nu}\ham_{q} + G\del{}{\mu}\ham_{p}G^{2}\del{}{\rho}\ham G\del{}{\nu}\ham_{q})e^{\rho\mu\nu} \\
	=& \tr(\del{}{\rho}\ham G\del{}{\mu}\ham_{p}G^{2}\del{}{\nu}\ham_{q} - G\del{}{\rho}\ham G^{2}\del{}{\mu}\ham_{q}G\del{}{\nu}\ham_{p} + G\del{}{\mu}\ham_{p}G^{2}\del{}{\rho}\ham G\del{}{\nu}\ham_{q})e^{\rho\mu\nu}.
\end{align*}
Somehow we are to find
\begin{align*}
	F^{(3)}_{pq} = \frac{i}{6}\oint\frac{\dd{z}}{2\pi i}\tr(G^{2}\df{\ham}G\df{\ham_{p}}G\df{\ham_{q}} - G\df{\ham}G^{2}\df{\ham_{p}}G\df{\ham_{q}}) - (p \leftrightarrow q).
\end{align*}

To compute this we expand in eigenstates of the Hamiltonian according to
\begin{align*}
	G^{2}\df{\ham}G\df{\ham_{p}}G\df{\ham_{q}} =& \sum\frac{\op{1}\op{2}\df{\ham}\op{3}\df{\ham_{p}}\op{4}\df{\ham_{q}}}{(z - E_{1})(z - E_{2})(z - E_{3})(z - E_{4})} \\
	=& \sum\frac{\op{1}\df{\ham}\op{2}\df{\ham_{p}}\op{3}\df{\ham_{q}}}{(z - E_{1})^{2}(z - E_{2})(z - E_{3})}.
\end{align*}
Let us now compute the contour integral around the ground state. The contributions from where only one number is zero is
\begin{align*}
	\sum &-\op{0}\df{\ham}\op{2}\df{\ham_{p}}\op{3}\df{\ham_{q}}\left(\frac{1}{(E_{0} - E_{2})^{2}(E_{0} - E_{3})} + \frac{1}{(E_{0} - E_{2})(E_{0} - E_{3})^{2}}\right) \\
	&+ \frac{\op{1}\df{\ham}\op{0}\df{\ham_{p}}\op{3}\df{\ham_{q}}}{(E_{0} - E_{1})^{2}(E_{0} - E_{3})} + \frac{\op{1}\df{\ham}\op{2}\df{\ham_{p}}\op{0}\df{\ham_{q}}}{(E_{0} - E_{1})^{2}(E_{0} - E_{2})}.
\end{align*}
Introducing
\begin{align*}
	G_{0} = \sum\limits_{n\neq 0}\frac{1}{E_{0} - E_{n}}\op{n},
\end{align*}
this can be written as
\begin{align*}
	&-\op{0}\left(\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{q}} + \df{\ham}G_{0}\df{\ham_{p}}G_{0}^{2}\df{\ham_{q}}\right) + G_{0}^{2}\df{\ham}\op{0}\df{\ham_{p}}G_{0}\df{\ham_{q}} + G_{0}^{2}\df{\ham}G_{0}\df{\ham_{p}}\op{0}\df{\ham_{q}}.
\end{align*}
Similarly, when two of the numbers are zero we get the contribution
\begin{align*}
	 &\sum\frac{1}{2}\left(2\frac{\op{0}\df{\ham}\op{0}\df{\ham_{p}}\op{3}\df{\ham_{q}}}{(E_{0} - E_{3})^{3}} + 2\frac{\op{0}\df{\ham}\op{2}\df{\ham_{p}}\op{0}\df{\ham_{q}}}{(E_{0} - E_{2})^{3}}\right) - 2\frac{\op{1}\df{\ham}\op{0}\df{\ham_{p}}\op{0}\df{\ham_{q}}}{(E_{0} - E_{1})^{3}} \\
	=& \op{0}\df{\ham}\op{0}\df{\ham_{p}}G_{0}^{3}\df{\ham_{q}} + \op{0}\df{\ham}G_{0}^{3}\df{\ham_{p}}\op{0}\df{\ham_{q}} - 2G_{0}^{3}\df{\ham}\op{0}\df{\ham_{p}}\op{0}\df{\ham_{q}}.
\end{align*}
Finally, if none or all of them are zero there is no contribution. Next, we have
\begin{align*}
	G\df{\ham}G^{2}\df{\ham_{p}}G\df{\ham_{q}} =& \sum\frac{\op{1}\df{\ham}\op{2}\df{\ham_{p}}\op{3}\df{\ham_{q}}}{(z - E_{1})(z - E_{2})^{2}(z - E_{3})}.
\end{align*}
The contributions after computing the contour integral are
\begin{align*}
	\sum &-\op{1}\df{\ham}\op{0}\df{\ham_{p}}\op{3}\df{\ham_{q}}\left(\frac{1}{(E_{0} - E_{1})^{2}(E_{0} - E_{3})} + \frac{1}{(E_{0} - E_{1})(E_{0} - E_{3})^{2}}\right) \\
	&+ \frac{\op{0}\df{\ham}\op{2}\df{\ham_{p}}\op{3}\df{\ham_{q}}}{(E_{0} - E_{2})^{2}(E_{0} - E_{3})} + \frac{\op{1}\df{\ham}\op{2}\df{\ham_{p}}\op{0}\df{\ham_{q}}}{(E_{0} - E_{1})(E_{0} - E_{2})^{2}} \\
	=& -G_{0}^{2}\df{\ham}\op{0}\df{\ham_{p}}G_{0}\df{\ham_{q}} - G_{0}\df{\ham}\op{0}\df{\ham_{p}}G_{0}^{2}\df{\ham_{q}} + \op{0}\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{q}} + G_{0}\df{\ham}G_{0}^{2}\df{\ham_{p}}\op{0}\df{\ham_{q}}
\end{align*}
when one number is zero and
\begin{align*}
	 &\sum\frac{1}{2}\left(2\frac{\op{0}\df{\ham}\op{0}\df{\ham_{p}}\op{3}\df{\ham_{q}}}{(E_{0} - E_{3})^{3}} + 2\frac{\op{1}\df{\ham}\op{0}\df{\ham_{p}}\op{0}\df{\ham_{q}}}{(E_{0} - E_{1})^{3}}\right) - 2\frac{\op{0}\df{\ham}\op{2}\df{\ham_{p}}\op{0}\df{\ham_{q}}}{(E_{0} - E_{2})^{2}} \\
	=& \op{0}\df{\ham}\op{0}\df{\ham_{p}}G_{0}^{3}\df{\ham_{q}} + G_{0}^{3}\df{\ham}\op{0}\df{\ham_{p}}\op{0}\df{\ham_{q}} - 2\op{0}\df{\ham}G_{0}^{3}\df{\ham_{p}}\op{0}\df{\ham_{q}}
\end{align*}
when two are. The final result is thus
\begin{align*}
	F^{(3)}_{pq} = \frac{i}{6}&\left(-\expval{\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{q}}} - \expval{\df{\ham}G_{0}\df{\ham_{p}}G_{0}^{2}\df{\ham_{q}}} + \expval{\df{\ham_{p}}G_{0}\df{\ham_{q}}G_{0}^{2}\df{\ham}} \right. \\
	&+ \left. \expval{\df{\ham_{q}}G_{0}^{2}\df{\ham}G_{0}\df{\ham_{p}}} + \expval{\df{\ham}}\expval{\df{\ham_{p}}G_{0}^{3}\df{\ham_{q}}} + \expval{\df{\ham}G_{0}^{3}\df{\ham_{p}}}\expval{\df{\ham_{q}}} \right. \\
	&- \left. 2\expval{\df{\ham_{q}}G_{0}^{3}\df{\ham}}\expval{\df{\ham_{p}}} + \expval{\df{\ham_{p}}G_{0}\df{\ham_{q}}G_{0}^{2}\df{\ham}} + \expval{\df{\ham_{p}}G_{0}^{2}\df{\ham_{q}}G_{0}\df{\ham}} \right. \\
	&- \left. \expval{\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{q}}} - \expval{\df{\ham_{q}}G_{0}\df{\ham}G_{0}^{2}\df{\ham_{p}}} - \expval{\df{\ham}}\expval{\df{\ham_{p}}G_{0}^{3}\df{\ham_{q}}} \right. \\
	&- \left. \expval{\df{\ham_{p}}}\expval{\df{\ham_{q}}G_{0}^{3}\df{\ham}} + 2\expval{\df{\ham}G_{0}^{3}\df{\ham_{p}}}\expval{\df{\ham_{q}}}\right) - (p \leftrightarrow q) \\
	= \frac{i}{6}&\left(-2\expval{\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{q}}} - \expval{\df{\ham}G_{0}\df{\ham_{p}}G_{0}^{2}\df{\ham_{q}}} + 2\expval{\df{\ham_{p}}G_{0}\df{\ham_{q}}G_{0}^{2}\df{\ham}} \right. \\
	&+ \left. \expval{\df{\ham_{p}}G_{0}^{2}\df{\ham_{q}}G_{0}\df{\ham}} + \expval{\df{\ham_{q}}G_{0}^{2}\df{\ham}G_{0}\df{\ham_{p}}} - \expval{\df{\ham_{q}}G_{0}\df{\ham}G_{0}^{2}\df{\ham_{p}}} \right. \\
	&+ \left. 3\expval{\df{\ham}G_{0}^{3}\df{\ham_{p}}}\expval{\df{\ham_{q}}} - 3\expval{\df{\ham_{q}}G_{0}^{3}\df{\ham}}\expval{\df{\ham_{p}}}\right) - (p \leftrightarrow q),
\end{align*}
where all the expectation values are computed in the ground state.

This quantity is somewhat difficult to manage, but one can reduce it somewhat. First, states excited outside of the support of $\ham_{p}$ and $\ham_{q}$ do not contribute, as they are orthogonal to the ground state and can pass through $\ham_{p}$ and $\ham_{q}$, as well as their exterior derivatives. By a similar token, $F^{(3)}_{pq}$ is non-zero only if $\ham_{p}$ and $\ham_{q}$ have overlapping support. This also implies that the only terms in the Hamiltonian that contribute are the ones with support overlapping with both $\ham_{p}$ and $\ham_{q}$.

Using these quantities we can construct a 3-form Berry curvature
\begin{align*}
	\Omega^{(3)}(f) = \frac{1}{2}\sum\limits_{p, q\in\mathbb{Z}}F^{(3)}_{pq}(f(q) - f(p)).
\end{align*}
$f$ is some sigmoid function, its particular shape turning out to be unimportant. A simple choice is $f(p) = \Theta(p - a)$ for some $a\in\mathbb{Z} + \frac{1}{2}$. For this particular choice we have
\begin{align*}
	\Omega^{(3)}(f) =& \frac{1}{2}\sum\limits_{p, q\in\mathbb{Z}}F^{(3)}_{pq}(\Theta(q - a) - \Theta(p - a)) \\
	                =& \frac{1}{2}\sum\limits_{p\in\mathbb{Z},\ q > a}F^{(3)}_{pq}(1 - \Theta(p - a)) - \frac{1}{2}\sum\limits_{p\in\mathbb{Z},\ q < a}F^{(3)}_{pq}\Theta(p - a) \\
	                =& \frac{1}{2}\sum\limits_{p < a,\ q > a}F^{(3)}_{pq} - \frac{1}{2}\sum\limits_{p > a,\ q < a}F^{(3)}_{pq} \\
	                =& \sum\limits_{p < a,\ q > a}F^{(3)}_{pq},
\end{align*}
using the antisymmetry of $F^{(3)}_{pq}$.

Finally we can define the KS invariant
\begin{align*}
	Q_{\text{KS}} = \inte{}{}\Omega^{(3)}(f),
\end{align*}
with integration over the full parameter space of the Hamiltonian. This is a topological invariant.

\paragraph{The Dimerized Spin Chain}
Consider an infinite spin chain with Hamiltonian
\begin{align*}
	\ham_{1d} = \sum\limits_{p\in\mathbb{Z}}\ham^{1}_{p}(w) + \sum\limits_{p\in 2\mathbb{Z} + 1}\ham^{2, +}_{p, p + 1}(w) + \sum\limits_{p\in 2\mathbb{Z}}\ham^{2, -}_{p, p + 1}(w).
\end{align*}
The parameter takes values on $S^{3}$. There are three kinds of terms here. The first is
\begin{align*}
	\ham^{1}_{p}(w) = (-1)^{p}(w_{1}\sigma_{p}^{1} + w_{2}\sigma_{p}^{2}+ w_{3}\sigma_{p}^{3}),
\end{align*}
which is some fluctuating on-site term. The two others are
\begin{align*}
	\ham^{2, \pm}_{p, p + 1}(w) = g^{\pm}(w)\sum\limits_{\mu = 1, 2, 3}\sigma_{p}^{\mu}\sigma_{p + 1}^{\mu},
\end{align*}
with two functions
\begin{align*}
	g^{+}(w) = \begin{cases}
		w_{4},\ 0\leq w_{4} \leq 1, \\
		0,\ \text{otherwise},
	\end{cases}
	g^{-}(w) = \begin{cases}
		-w_{4},\ -1\leq w_{4} \leq 0, \\
		0,\ \text{otherwise}.
	\end{cases}
\end{align*}
This type of interaction defines five distinct regimes:
\begin{itemize}
	\item $w_{4} = 1$, where there is only odd-even bonding.
	\item $0 < w_{4} < 1$, where there is odd-even bonding and on-site interactions.
	\item $w_{4} = 0$, where there is only on-site interaction.
	\item $-1 < w_{4} < 0$, where there is even-odd bonding and on-site interactions.
	\item $w_{4} = 1$, where there is only even-odd bonding.
\end{itemize}

To compute the 3-form Berry curvature and KS invariant, we rewrite the Hamiltonian as a sum of local terms. These are
\begin{align*}
	\ham_{p}(w) = \ham^{1}_{p}(w) + x\ham^{2, \pm}_{p, p + 1}(w) + (1 - x)\ham^{2, \mp}_{p - 1, p}(w).
\end{align*}
The top sign is for odd $p$. The new parameter $x$ is an extra control parameter, taken to be fixed. Its introduction is an explicit representation of the ambiguity of the choice of local terms.

For the sigmoid function $f$ we choose a Heaviside function, this time leaving us with two variants - $f$ with $a\in 2\mathbb{Z} - \frac{1}{2}$ and $f\p$ with $a\in 2\mathbb{Z} + \frac{1}{2}$. To see how they differ, consider the regime $w_{4} > 0$. In this case $f$ splits the dimer in two and $f\p$ switches on between two dimers.

Because the local terms in the Hamiltonian only interact at range $1$ in either direction, the eigenstates of the system for any parameter choice are product states over each dimer. This means
\begin{align*}
	\Omega^{(3)}(f) = \Omega^{(3)}(f\p) = F^{(3)}_{a - \frac{1}{2}, a + \frac{1}{2}},
\end{align*}
with the particular choice of $a$ distinguishing the two cases. $\Omega^{(3)}(f)$ is only non-trivial if the sites $a \pm \frac{1}{2}$ belong to the same dimer, hence $\Omega^{(3)}(f) = 0$ unless $w_{4} > 0$ and $\Omega^{(3)}(f\p) = 0$ unless $w_{4} < 0$.

We will need to diagonalize the dimer, so we first transform the basis from an angle-independent one into one parallel with the Zeeman field using a unitary operator $U$. This transforms states according to $\ket{\psi}\to \ket{\psi}_{\theta, \phi} = U\ket{\psi}$ and any operator according to $A\to a = UAU\adj$, the explicit angle dependence having been removed from the left-hand side of both equalities. This angle dependence is instead baked into the basis. The small-letter notation will be useful for clarification when a matrix representation is invoked. Having applied this transformation we choose simultaneous eigenstates of $S_{z, p}\p + S_{z, p + 1}\p$ and $(S_{p}\p + S_{p + 1}\p)^{2}$, which are also eigenstates of $(S_{p}\p)^{2}$ and $(S_{p + 1}\p)^{2}$. The vector appearing in the Zeeman term has length $\sqrt{1 - w_{4}^{2}}$, meaning
\begin{align*}
	h_{p} = -2\sqrt{1 - w_{4}^{2}}S_{z, p}\p + 4xw_{4}S_{p}\p\cdot S_{p + 1}\p,\ h_{p + 1} = 2\sqrt{1 - w_{4}^{2}}S_{z, p + 1} + 4(1 - x)w_{4}S_{p}\p\cdot S_{p + 1}\p
\end{align*}
for $p = a - \frac{1}{2}$. Furthermore, as
\begin{align*}
	S_{p}\p\cdot S_{p + 1}\p = \frac{1}{2}((S_{p}\p + S_{p + 1}\p)^{2} - (S_{p}\p)^{2} - (S_{p + 1}\p)^{2}),
\end{align*}
we have
\begin{align*}
	h_{p} &= -\sqrt{1 - w_{4}^{2}}\mqty[
		1 & 0 & 0  & 0 \\
		0 & 0 & 0  & 1 \\
		0 & 0 & -1 & 0 \\
		0 & 1 & 0  & 0 
	] + 2xw_{4}\mqty[
		\frac{1}{2} & 0           & 0 & 0 \\
		0           & \frac{1}{2} & 0 & 0 \\
		0           & 0           & \frac{1}{2} & 0 \\
		0           & 0           & 0           & -\frac{3}{2} 
	], \\
	h_{p + 1} &= \sqrt{1 - w_{4}^{2}}\mqty[
		1 & 0  & 0  & 0 \\
		0 & 0  & 0  & -1 \\
		0 & 0  & -1 & 0 \\
		0 & -1 & 0  & 0 
	] + (1 - x)w_{4}\mqty[
		1 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 \\
		0 & 0 & 1 & 0 \\
		0 & 0 & 0 & -3
	]
\end{align*}
in the eigenbasis of total spin, and the total dimer Hamiltonian is
\begin{align*}
	h = w_{4}\mqty[
		1 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 \\
		0 & 0 & 1 & 0 \\
		0 & 0 & 0 & -3
	] - 2\sqrt{1 - w_{4}^{2}}\mqty[
		0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 1 \\
		0 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 
	].
\end{align*}
The eigenstates $\ket{1, 1}$ and $\ket{1, -1}$ are still eigenstates of the total Hamiltonian, with energy $w_{4}$. In addition there are two eigenstates found by diagonalizing
\begin{align*}
	\mqty[
		w_{4}                  & -2\sqrt{1 - w_{4}^{2}} \\
		-2\sqrt{1 - w_{4}^{2}} & -3w_{4}
	].
\end{align*}
The energies are $\pm 2 - w_{4}$, with eigenstates
\begin{align*}
	\frac{1}{\sqrt{2}}\mqty[
		-\sqrt{1 + w_{4}} & \sqrt{1 - w_{4}} \\
		\sqrt{1 - w_{4}}  & \sqrt{1 + w_{4}}
	].
\end{align*}

We proceed by introducing hyperspherical coordinates
\begin{align*}
	w_{1} = \sin(\alpha)\cos(\theta),\ w_{2} = \sin(\alpha)\sin(\theta)\cos(\phi),\ w_{3} = \sin(\alpha)\sin(\theta)\sin(\phi),\ w_{4} = \cos(\alpha),
\end{align*}
for which we have
\begin{align*}
	h_{p} &= -\sin(\alpha)\mqty[
		1 & 0 & 0  & 0 \\
		0 & 0 & 0  & 1 \\
		0 & 0 & -1 & 0 \\
		0 & 1 & 0  & 0 
	] + x\cos(\alpha)\mqty[
		1 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 \\
		0 & 0 & 1 & 0 \\
		0 & 0 & 0 & -3
	], \\
	h_{p + 1} &= \sin(\alpha)\mqty[
		1 & 0  & 0  & 0 \\
		0 & 0  & 0  & -1 \\
		0 & 0  & -1 & 0 \\
		0 & -1 & 0  & 0 
	] + (1 - x)\cos(\alpha)\mqty[
		1 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 \\
		0 & 0 & 1 & 0 \\
		0 & 0 & 0 & -3
	], \\
	h_{p} + h_{p + 1} =& h = \cos(\alpha)\mqty[
		1 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 \\
		0 & 0 & 1 & 0 \\
		0 & 0 & 0 & -3
	] - 2\sin(\alpha)\mqty[
		0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 1 \\
		0 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 
	].
\end{align*}
The eigenstates of individual spin are given in equation \ref{eq:spin_angle_states}, and we then have
\begin{align*}
	\ket{1, 1}_{\theta, \phi} &= \mqty[
		\cos[2](\frac{\theta}{2})e^{-2i\phi} \\
		\frac{1}{\sqrt{2}}\sin(\theta)e^{-i\phi} \\
		\sin[2](\frac{\theta}{2}) \\
		0
	],\ \ket{1, 0}_{\theta, \phi} = \mqty[
		-\frac{1}{\sqrt{2}}\sin(\theta)e^{-2i\phi} \\
		\cos(\theta)e^{-i\phi} \\
		\frac{1}{\sqrt{2}}\sin(\theta) \\
		0
	],\ \ket{1, -1}_{\theta, \phi} &= \mqty[
		\sin[2](\frac{\theta}{2})e^{-2i\phi} \\
		-\frac{1}{\sqrt{2}}\sin(\theta)e^{-i\phi} \\
		\cos[2](\frac{\theta}{2}) \\
		0
	],\ \ket{0, 0}_{\theta, \phi} = \mqty[
		0 \\
		0 \\
		0 \\
		e^{-i\phi}
	]
\end{align*}
with respect to the total spin basis for $\theta = \phi = 0$. We can then explicitly write
\begin{align*}
	U = \mqty[
		\cos[2](\frac{\theta}{2})e^{-2i\phi} & -\frac{1}{\sqrt{2}}\sin(\theta)e^{-2i\phi} & \sin[2](\frac{\theta}{2})e^{-2i\phi} & 0 \\
		\frac{1}{\sqrt{2}}\sin(\theta)e^{-i\phi} & \cos(\theta)e^{-i\phi} & -\frac{1}{\sqrt{2}}\sin(\theta)e^{-i\phi} & 0 \\
		\sin[2](\frac{\theta}{2}) & \frac{1}{\sqrt{2}}\sin(\theta) & \cos[2](\frac{\theta}{2}) & 0 \\
		0 & 0 & 0 & e^{-i\phi}
	].
\end{align*}

Let us also derive an expression for $g_{0}$. The eigenstates of the Hamiltonian in the angle-dependent basis are
\begin{align*}
	v_{-2 - \cos(\alpha)} = \frac{1}{\sqrt{2}}\mqty[
		0 \\
		\sqrt{1 - \cos(\alpha)} \\
		0 \\
		\sqrt{1 + \cos(\alpha)}
	],\ v_{\cos(\alpha), 1} = \mqty[
		1 \\
		0 \\
		0 \\
		0
	],\ v_{\cos(\alpha), 2} = \mqty[
		0 \\
		0 \\
		1 \\
		0
	],\ v_{2 - \cos(\alpha)} = \frac{1}{\sqrt{2}}\mqty[
		0 \\
		-\sqrt{1 + \cos(\alpha)} \\
		0 \\
		\sqrt{1 - \cos(\alpha)}
	].
\end{align*}
Forming these into a matrix $V$ and computing $VDV^{-1}$ for
\begin{align*}
	D =& \mqty[
		-\frac{1}{2(1 + \cos(\alpha))} & 0 & 0 & 0 \\
		0 & 0 & 0 & 0 \\
		0 & 0 & -\frac{1}{2(1 + \cos(\alpha))} & 0 \\
		0 & 0 & 0 & -\frac{1}{4}
	]
\end{align*}
nets us
\begin{align*}
	g_{0} =  \mqty[
		-\frac{1}{2(1 + \cos(\alpha))} & 0 & 0 & 0 \\
		0 & -\frac{1}{8}(1 + \cos(\alpha)) & 0 & \frac{1}{8}\sin(\alpha) \\
		0 & 0 & -\frac{1}{2(1 + \cos(\alpha))} & 0 \\
		0 & \frac{1}{8}\sin(\alpha) & 0 & -\frac{1}{8}(1 - \cos(\alpha))
	].
\end{align*}

The three angles are now neatly separated, as $\phi$ and $\theta$ only enter in $U$ and $\alpha$ only enters in the combination of eigenstates after $U$ has been applied. Using the explicit formula we then have
\begin{align*}
	F^{(3)}_{p, p + 1} =& \frac{i}{6}\left(-2\expval{\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{p + 1}}} - \expval{\df{\ham}G_{0}\df{\ham_{p}}G_{0}^{2}\df{\ham_{p + 1}}} + 2\expval{\df{\ham_{p}}G_{0}\df{\ham_{p + 1}}G_{0}^{2}\df{\ham}} \right. \\
	&+ \left. \expval{\df{\ham_{p}}G_{0}^{2}\df{\ham_{p + 1}}G_{0}\df{\ham}} + \expval{\df{\ham_{p + 1}}G_{0}^{2}\df{\ham}G_{0}\df{\ham_{p}}} - \expval{\df{\ham_{p + 1}}G_{0}\df{\ham}G_{0}^{2}\df{\ham_{p}}} \right. \\
	&+ \left. 3\expval{\df{\ham}G_{0}^{3}\df{\ham_{p}}}\expval{\df{\ham_{p + 1}}} - 3\expval{\df{\ham_{p + 1}}G_{0}^{3}\df{\ham}}\expval{\df{\ham_{p}}}\right) - (p \leftrightarrow p + 1).
\end{align*}
In order to get non-trivial results, we must compute these expectation values in an angle-independent basis. To that end, we note that all the operators involved only depend on $\alpha$ in the angle-dependent basis. We then write $A = U\adj aU$ and consider its expectation value in some angle-dependent state $\ket{\psi} = U\adj\ket{\psi}_{\theta, \phi}$. We then have
\begin{align*}
	\expval{A}{\psi} = \expval{UU\adj aUU\adj}{\psi}_{\theta, \phi} = \expval{a}{\psi}_{\theta, \phi}.
\end{align*}
This means, for instance, that
\begin{align*}
	\expval{\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{p + 1}}} =& \expval{U(\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{p + 1}})_{\theta, \phi}U\adj}_{\theta, \phi} \\
	=& \expval{U\df{(U\adj hU)}U\adj g_{0}^{2}U\df{(U\adj h_{p}U)}U\adj g_{0}U\df{(U\adj h_{p + 1}U)}U\adj}_{\theta, \phi}.
\end{align*}

This should generally be a polynomial of order up to 2 in $x$. To simplify the calculation we could start by eliminating terms. For example, the order-2 terms come from the contributions where $h_{p}$ and $h_{p + 1}$ look identical. By antisymmetry with respect to the lattice sites these terms vanish, and the remaining contributions are of order 1 at most.

By antisymmetry we may compute any component of this form, so we choose $F^{(3)}_{p, p + 1, \alpha\theta\phi}$, for which the two latter terms vanish.

This is going to take some time, so let's start. We have
\begin{align*}
	 &\expval{\df{\ham}G_{0}^{2}\df{\ham_{p}}G_{0}\df{\ham_{p + 1}}} \\
	=& -\frac{i}{64}\cos(\theta)\left(\cos(\alpha)-1\right) \left(2 \sin(\alpha)\cos[2](\alpha) - 2\cos[3](\alpha) - 5 \sin(\alpha)\cos(\alpha) + 3\cos(\alpha)^{2} + \sin(\alpha) + 4\cos(\alpha) + 3\right)
\end{align*}

Using the explicit formula above we somehow find
\begin{align*}
	\Omega^{(3)}_{\alpha\theta\phi} = \frac{1}{2}(2 + \cos(\alpha))\tan[2](\frac{\alpha}{2})\sin(\theta)
\end{align*}
for $0 < \alpha < \frac{\pi}{2}$. We then have
\begin{align*}
	Q_{\text{KS}} =& \inte{S^{3}}{}\Omega^{(3)}_{\alpha\theta\phi} = \frac{1}{2}\inte{0}{\frac{\pi}{2}}\inte{0}{\pi}\inte{0}{2\pi}\dd{\alpha}\dd{\theta}\dd{\phi}(2 + \cos(\alpha))\tan[2](\frac{\alpha}{2})\sin(\theta) \\
	              =& 2\pi\inte{0}{\frac{\pi}{2}}\dd{\alpha}(2 + \cos(\alpha))\tan[2](\frac{\alpha}{2}) = 2\pi.
\end{align*}

What if we were to use a different sigmoid? Swapping to $f\p$, which is zero for $w_{4} > 0$. Elsewhere we find
\begin{align*}
	\Omega^{(3)}_{\alpha\theta\phi} = \frac{1}{2}(2 - \cos(\alpha))\cot[2](\frac{\alpha}{2})\sin(\theta),
\end{align*}
and thus
\begin{align*}
	Q_{\text{KS}} =& 2\pi\inte{\frac{\pi}{2}}{\pi}\dd{\alpha}(2 - \cos(\alpha))\cot[2](\frac{\alpha}{2}) \\
	              =& -2\pi\inte{\frac{\pi}{2}}{0}\dd{\beta}(2 - \cos(\pi - \beta))\cot[2](\frac{\pi - \beta}{2}) \\
	              =& 2\pi\inte{0}{\frac{\pi}{2}}\dd{\beta}(2 + \cos(\beta))\tan[2](\frac{\beta}{2}) \\
	              =& 2\pi,
\end{align*}
and indeed the choice of sigmoid was irrelevant.

\paragraph{Higher Berry Curvature in Arbitrary Dimensions}
We will construct higher Berry curvatures for lattice models in arbitrary dimensions by means of the language of chain complices. The links will be comprised of objects $A_{p_{0}\dots p_{n}}$, called $n$-chains, which depend on $n + 1$ points on a lattice $\Lambda$, are antisymmetric under permutations of the points and decay exponentially away from the diagonal $p_{0} = \dots = p_{n}$. These belong to the space $C_{n}(\Lambda)$. The map linking the chains is defined as
\begin{align*}
	(\del{}{}A)_{p_{1}\dots p_{n}} = \sum\limits_{p_{0}\in\Lambda}A_{p_{0}\dots p_{n}}.
\end{align*}
Dual to this we introduce $n$-cochains, which are functions $\alpha(p_{0}, \dots, p_{n})$ that depend on $n + 1$ lattice points, are antisymmetric under permutations and have the following property: When restricted to any $\delta$-neighborhood of the diagonal, it vanishes when any of the points is outside some finite set. These belong to the space $C^{n}(\Lambda)$.

Having defined the two, we introduce the pairing
\begin{align*}
	\braket{A}{\alpha} = \frac{1}{(n + 1)!}\sum\limits_{p_{0}, \dots, p_{n}}A_{p_{0}, \dots, p_{n}}\alpha(p_{0}, \dots, p_{n}).
\end{align*}
The cochains are linked by an operator $\delta$ which satisfies $\delta^{2} = 0$ and
\begin{align*}
	\braket{A}{\delta\alpha} = \braket{\del{}{}A}{\alpha},\ A\in C_{n},\ \alpha\in C^{n - 1}.
\end{align*}
To identify it, we write explicitly
\begin{align*}
	\braket{\del{}{}A}{\alpha} = \frac{1}{n!}\sum\limits_{p_{1}, \dots, p_{n}}\left(\sum\limits_{p_{0}}A_{p_{0}, \dots, p_{n}}\right)\alpha(p_{1}, \dots, p_{n}).
\end{align*}
We want to factorize this as a sum containing $A$ itself and some other object, so to do that, let us consider a simple example, namely $n = 1$. We have
\begin{align*}
	\sum\limits_{p_{1}, p_{2}}A_{p_{1}, p_{2}}\alpha(p_{2}) = \frac{1}{2}\sum\limits_{p_{1}, p_{2}}A_{p_{1}, p_{2}}\alpha(p_{2}) - A_{p_{2}, p_{1}}\alpha(p_{2}) = \frac{1}{2}\sum\limits_{p_{1}, p_{2}}A_{p_{1}, p_{2}}(\alpha(p_{2}) - \alpha(p_{1})).
\end{align*}
What we have achieved with this rewrite is pairing $A$ with an element of $C^{1}$, as the cochain now has dependence on two points. Performing a similar process for higher $n$ we find
\begin{align*}
	\delta\alpha(p_{0}, \dots, p_{n}) = \sum\limits_{i = 0}^{n}(-1)^{i}\alpha(p_{0}, \dots, p_{j - 1}, p_{j + 1}, \dots, p_{n}).
\end{align*}

The chains also have an exterior product, defined as
\begin{align*}
	\alpha\cup\gamma(p_{0}, \dots, p_{n + m}) = \frac{1}{(n + m + 1)!}\sum\limits_{\sigma\in S_{n + m + 1}}(-1)^{\text{sgn}(\sigma)}\alpha(p_{\sigma(0)}, \dots, p_{\sigma(n)})\gamma(p_{\sigma(n)}, \dots, p_{\sigma(n + m)}).
\end{align*}
It satisfies
\begin{align*}
	\alpha\cup\gamma = (-1)^{nm}\gamma\cup\alpha,\ \delta(\alpha\cup\gamma) = \delta\alpha\cup\gamma + (-1)^{n}\alpha\cup\delta\gamma.
\end{align*}

We now have the mathematical machinery to define the higher Berry curvature. Partially by inspiration from the calculation in $d = 1$, the starting point will be $n - 2$-chains $F^{(n)}$, which are valued in $n$-forms. From some starting point, these forms are defined by the descent equation
\begin{align*}
	\df{F^{(n)}} = \del{}{}F^{(n + 1)}.
\end{align*}
To construct a higher Berry curvature, we will need to contract these with some $n -2$-cochain - in other words, we will use some construction of the form
\begin{align*}
	\Omega^{(d + 2)} = \braket{F^{(d + 2)}}{\alpha}.
\end{align*}
The matching of numbers makes sense, as for $d = 0$ we want a 2-form (higher) Berry curvature with underlying dependence on at most one lattice point. We will also be interested in a higher KS invariant
\begin{align*}
	\inte{}{}\Omega^{(d + 2)}.
\end{align*}
The details of this construction may be of importance, so let us discuss the topological properties of the above. Under a deformation of the parameter manifold, the requirement that the KS invariant be conserved implies that $\Omega^{(d + 2)}$ must be closed. For the general construction above we have
\begin{align*}
	\df{\braket{F^{(d + 2)}}{\alpha}} = \braket{\df{F^{(d + 2)}}}{\alpha} = \braket{\del{}{}F^{(d + 3)}}{\alpha} = \braket{F^{(d + 3)}}{\delta\alpha}.
\end{align*}
The requirement that $\Omega^{(d + 2)}$ be closed thus implies that $\alpha$ must be closed. On the other hand, assuming $\alpha$ to be exact we have
\begin{align*}
	\Omega^{(d + 2)} = \braket{F^{(d + 2)}}{\delta\gamma} = \braket{\del{}{}F^{(d + 2)}}{\gamma} = \braket{\df{F^{(d + 1)}}}{\gamma} = \df{\braket{F^{(d + 1)}}{\gamma}},
\end{align*}
and as such the KS invariant is trivial. We thus see the importance of the cohomology of the cochain complex. It can be shown that the $n$th cohomology of the cochain complex is isomorphic to the $n$th cohomology of $R^{d}$. The latter is non-trivial for $n = d$ only, and is one-dimensional in this case. The significance of this result is twofold. First, it is the final nail in the coffin for $F^{(d + 2)}$ being a $d$-chain. Second, it dictates that we may construct the higher Berry curvature by choosing any one generator of $C^{d}$.

Let us now finish the construction. To arrive at a sensible definition, the starting point we choose is
\begin{align*}
	F^{(2)}_{p} = \frac{i}{2}\oint\frac{\dd{z}}{2\pi i}\tr(G\df{\ham}G^{2}\df{\ham_{p}}).
\end{align*}
Next we introduce functions $f_{i}$, some particular choice of sigmoid functions each depending the coordinate $x^{i}(p)$ of some lattice point $p$. The higher Berry curvature is then defined as
\begin{align*}
	\Omega^{(d + 2)} = \braket{F^{(d + 2)}}{\delta f_{1}\cup\dots\cup\delta f_{d}}.
\end{align*}

Before looking at some properties of the higher Berry curvature, let us first verify that this construction is sensible. We will do this by considering the two simplest examples. The first example is $d = 0$, for which the higher Berry curvature is
\begin{align*}
	\Omega^{(2)} = \braket{F^{(2)}}{1},
\end{align*}
as there is no lattice for $d = 0$. Evaluating this we find
\begin{align*}
	\Omega^{(2)} = \frac{i}{2}\oint\frac{\dd{z}}{2\pi i}\tr(G\df{\ham}G^{2}\df{\ham}),
\end{align*}
and the definition is consistent with the usual Berry curvature. Note also that $\Omega^{(2)} = \df{A} = \del{}{}F^{(2)}$, and so the Berry connection is the true start.

Next, for $d = 1$ we introduce the sigmoid functions $f$ and form a 1-cochain according to
\begin{align*}
	\delta f(p, q) = f(p) - f(q).
\end{align*}
The 1-chain for this case is $F^{(3)}$, which satisfies $\df{F^{(2)}} = \del{}{}F^{(3)}$. The higher Berry curvature for this case is
\begin{align*}
	\Omega^{(3)} = \braket{F^{(3)}}{\delta f} = \frac{1}{2}\sum\limits_{p, q}F_{pq}^{(3)}(f(p) - f(q)),
\end{align*}
which is the same result as we previously arrived at.

Finally we investigate some properties of the higher Berry curvature. Firstly, it is closed, as
\begin{align*}
	\df{\Omega^{(d + 2)}} =& \braket{\df{F^{(d + 2)}}}{\delta f_{1}\cup\dots\cup\delta f_{d}} \\
	                      =& \braket{\del{}{}F^{(d + 3)}}{\delta f_{1}\cup\dots\cup\delta f_{d}} \\
	                      =& \braket{F^{(d + 3)}}{\delta(\delta f_{1}\cup\dots\cup\delta f_{d})} \\
	                      =& 0.
\end{align*}
Its cohomology class is also invariant under shifts by some compactly supported function. To show this, note that
\begin{align*}
	\braket{F^{(d + 2)}}{\delta g\cup f_{2}\cup\dots\cup\delta f_{d}} =& \braket{F^{(d + 2)}}{\delta(g\cup f_{2}\cup\dots\cup\delta f_{d})} \\
	=& \braket{\del{}{}F^{(d + 2)}}{g\cup f_{2}\cup\dots\cup\delta f_{d}} \\
	=& \braket{\df{F^{(d + 2)}}}{g\cup f_{2}\cup\dots\cup\delta f_{d}} \\
	=& \df{\braket{F^{(d + 2)}}{g\cup f_{2}\cup\dots\cup\delta f_{d}}}.
\end{align*}
As such, the exact choice of sigmoid is irrelevant.

\paragraph{Dimensional Reduction in Topological Insulators}
Topological insulators are generally described by some fermion model. Two classes of such models are A and AIII. The two are defined by not respecting time reversal and charge conjugation as symmetries. In addition, AIII has some unitary operator $\Gamma$ that anticommutes with the Hamiltonian, also known as having a chiral symmetry. The existence of the chiral symmetry implies symmetry of the energy spectrum about the Fermi level.

It turns out that every model of class A in even spatial dimension can be related to a model of class AIII in one lower dimension. The process of relating the two is termed dimensional reduction. The scheme is as follows: Start with a Dirac model in $d = 2n + 2$ dimensions given by
\begin{align*}
	\ham = m\Gamma_{(2n + 3)}^{2n + 3} + \sum\limits_{a = 1}^{2n + 2}k_{a}\Gamma_{(2n + 3)}^{a},
\end{align*}
with $\Gamma_{(2n + 3)}^{a}$ being generators of the $2n + 3$-dimensional Clifford algebra. This is the class A model. The dimensional reduction is performed by setting $k_{2n + 2} = 0$, yielding a model in $d = 2n + 2$ in class AIII, as the Hamiltonian now anticommutes with $\Gamma_{(2n + 3)}^{2n + 2}$.

Generally for these models we introduce Bloch states $\ket{u_{a}^{\pm}(k)}$, with $k$ being confined to the first Brillouin zone, $a$Â being a band index and the sign dictating whether the state is occupied. From this we can define a non-Abelian Berry curvature for the occupied state according to
\begin{align*}
	A_{ab, \mu} = \mel{u_{a}^{-}(k)}{\del{}{\mu}}{u_{b}^{-}(k)}.
\end{align*}
The Berry curvature is then $F = \df{A} + A^{2}$. Models in class A in $d = 2n + 2$ can be characterized by the $n + 1$th Chern character
\begin{align*}
	\text{ch}_{n + 1}(F) = \frac{1}{(n + 1)!}\tr(\left(\frac{iF}{2\pi}\right)^{n + 1}),
\end{align*}
as well as its integral, called the Chern number. The Chern character is the exterior derivative of the $2(n + 1) - 1$th Chern-Simons form, defined as
\begin{align*}
	Q_{2n + 1} = \frac{1}{n!}\left(\frac{i}{2\pi}\right)^{n + 1}\inte{0}{1}\dd{t}\tr(AF_{t}^{n}),\ F_{t} = t\df{A} + t^{2}A^{2} = tF + (t^{2} - t)A^{2}.
\end{align*}
Note that the Chern-Simons form is not gauge invariant. Instead, for a gauge transformation
\begin{align*}
	A\p = g^{-1}Ag + g^{-1}\df{g},\ F\p = g^{-1}Fg,
\end{align*}
we have
\begin{align*}
	Q_{2n + 1}\p =& \frac{1}{n!}\left(\frac{i}{2\pi}\right)^{n + 1}\inte{0}{1}\dd{t}\tr(\left(g^{-1}Ag + g^{-1}\df{g}\right)\left(tg^{-1}Fg + (t^{2} - t)(g^{-1}Ag + g^{-1}\df{g})^{2}\right)^{n}) \\
	             =& \frac{1}{n!}\left(\frac{i}{2\pi}\right)^{n + 1}\inte{0}{1}\dd{t}\tr(\left(g^{-1}Ag + g^{-1}\df{g}\right)\left(tg^{-1}Fg + (t^{2} - t)(g^{-1}A^{2}g + g^{-1}A\df{g} +  + g^{-1}\df{g}g^{-1}Ag + g^{-1}\df{g}g^{-1}\df{g})\right)^{n})
\end{align*}
One term here is of course $Q_{2n + 1}$. The other is the result of setting $A = g^{-1}\df{g}$ and $F = 0$ in the Chern-Simons form. The remaining terms are the exterior derivative of some $2n$-form, somehow.

To introduce a similar concept for class AIII, we first introduce the projection matrix $P(k)$ onto the occupied bands and $Q = 1 - 2P$. The chiral symmetry somehow implies that the $Q$ matrix can be written as
\begin{align*}
	Q = \mqty[
		0     & q \\
		q\adj & 0
	],
\end{align*}
with $q$ being a unitary matrix, in the basis where $\Gamma$ is diagonal. We can now introduce the winding number for a model in AIII and $d = 2n + 1$ as
\begin{align*}
	\nu_{2n + 1} = \inte{}{}\omega_{2n + 1}(q),\ \omega_{2n + 1}(q) = \frac{(-1)^{n}n!}{(2n + 1)!}\left(\frac{i}{2\pi}\right)^{n + 1}\tr((q^{-1}\df{q})^{2n + 1}).
\end{align*}
The Chern-Simons forms define a characteristic class on odd-dimensional manifolds, meaning we can use them to characterize systems. We therefore introduce the Chern-Simons invariant
\begin{align*}
	\text{CS}_{2n + 1} = \inte{}{}Q_{2n + 1},
\end{align*}
with the integral being over the first Brillouin zone. Returning to the issue of gauge invariance, evaluating the Chern-Simons form at $g^{-1}\df{g}$ gives the same result as the winding number evaluated at $g$. The winding number is an integer which in this case measures the winding $g$ about the Brillouin zone. Note that $\pi_{\text{BZ}}(U(N)) = \mathbb{Z}$. It therefore follows that the Wilson loop
\begin{align*}
	W_{2n + 1} = e^{2\pi i\text{CS}_{2n + 1}}
\end{align*}
is gauge invariant.

Let us move on to a more specific example. The simplest would be starting in $d = 2$ with the Hamiltonian
\begin{align*}
	\ham = k_{x}\sigma_{x} + k_{y}\sigma_{y} + m\sigma_{z}.
\end{align*}
Introducing $\lambda = \sqrt{k^{2} + m^{2}}$, the eigenstates are given by
\begin{align*}
	\ket{u^{-}(k)} = \frac{1}{\sqrt{2\lambda(\lambda + m)}}\mqty[
		-k_{x} + ik_{y} \\
		\lambda + m
	],\ \ket{u^{+}(k)} = \frac{1}{\sqrt{2\lambda(\lambda - m)}}\mqty[
		k_{x} - ik_{y} \\
		\lambda - m
	].
\end{align*}
Writing
\begin{align*}
	\del{}{\mu}f(\sqrt{k^{2} + m^{2}}) = f\p\frac{k_{\mu}}{\sqrt{k^{2} + m^{2}}}
\end{align*}
we find
\begin{align*}
	A_{x} =& \frac{1}{\sqrt{2\lambda(\lambda + m)}}\mqty[
	-k_{x} - ik_{y} & \lambda + m
	]\mqty[
		-\frac{1}{\sqrt{2\lambda(\lambda + m)}} - \frac{(-k_{x} + ik_{y})(4\lambda + 2m)}{2(2\lambda(\lambda + m))^{\frac{3}{2}}}\frac{k_{x}}{\lambda} \\
		-\frac{\frac{m}{2\lambda^{2}}}{2\sqrt{\frac{1}{2} + \frac{m}{2\lambda}}}\frac{k_{x}}{\lambda}
	] \\
	=& \frac{1}{2\lambda(\lambda + m)}\mqty[
	-k_{x} - ik_{y} & \lambda + m
	]\mqty[
	-1 - \frac{(-k_{x} + ik_{y})(2\lambda + m)}{2\lambda(\lambda + m)}\frac{k_{x}}{\lambda} \\
	-\frac{mk_{x}}{2\lambda^{2}}
	] \\
	=& \frac{1}{2\lambda(\lambda + m)}\left(k_{x} + ik_{y} - \frac{k^{2}(2\lambda + m)k_{x}}{2\lambda^{2}(\lambda + m)} - \frac{m(\lambda + m)k_{x}}{2\lambda^{2}}\right) \\
	=& \frac{ik_{y}}{2\lambda(\lambda + m)} + \frac{k_{x}}{4\lambda^{3}(\lambda + m)^{2}}\left(2\lambda^{2}(\lambda + m) - k^{2}(2\lambda + m) - m(\lambda + m)^{2}\right) \\
	=& \frac{ik_{y}}{2\lambda(\lambda + m)} + \frac{k_{x}}{4\lambda^{3}(\lambda + m)^{2}}\left(2\lambda^{3} + 2\lambda^{2}m - 2k^{2}\lambda - k^{2}m - m(\lambda^{2} + m^{2} + 2\lambda m)\right) \\
	=& \frac{ik_{y}}{2\lambda(\lambda + m)}.
\end{align*}
By symmetry we have
\begin{align*}
	A_{y} =& \frac{1}{2\lambda(\lambda + m)}\mqty[
		-k_{x} - ik_{y} & \lambda + m
	]\mqty[
		i - \frac{(-k_{x} + ik_{y})(2\lambda + m)}{2\lambda(\lambda + m)}\frac{k_{y}}{\lambda} \\
		-\frac{mk_{y}}{2\lambda^{2}}
	] \\
	=& -\frac{i}{2\lambda(\lambda + m)}\mqty[
		-k_{x} - ik_{y} & \lambda + m
	]\mqty[
		-1 - \frac{(-k_{x} + ik_{y})(2\lambda + m)}{2\lambda(\lambda + m)}\frac{ik_{y}}{\lambda} \\
		-\frac{mik_{y}}{2\lambda^{2}}
	] \\
	=& -\frac{i}{2\lambda(\lambda + m)}\left(k_{x} + ik_{y} - \frac{k^{2}(2\lambda + m)ik_{y}}{2\lambda^{2}(\lambda + m)} - \frac{m(\lambda + m)ik_{y}}{2\lambda^{2}}\right) \\
	=& -\frac{ik_{x}}{2\lambda(\lambda + m)}.
\end{align*}
The Berry curvature is then
\begin{align*}
	F_{xy} =& -\frac{i}{\lambda(\lambda + m)} + \frac{i(2\lambda + m)}{2\lambda^{3}(\lambda + m)^{2}}(k_{x}^{2} + k_{y}^{2}) \\
	       =& -\frac{i}{\lambda(\lambda + m)}\left(1 - \frac{(2\lambda + m)}{2\lambda^{2}(\lambda + m)}(\lambda^{2} - m^{2})\right) \\
	       =& -\frac{i}{2\lambda^{3}(\lambda + m)}\left(2\lambda^{2} - (\lambda - m)(2\lambda + m)\right) \\
	       =& -\frac{im}{2\lambda^{3}}.
\end{align*}
Approximating the integral over the first Brillouin zone to an integral over all momenta we have
\begin{align*}
	\text{Ch}_{1} =& \frac{i}{2\pi}\inte{}{}F = \frac{m}{4\pi}\inte{}{}\dd[2]{k}\frac{1}{(k^{2} + m^{2})^{\frac{3}{2}}} \\
	              =& \frac{m}{4\pi\abs{m}}\frac{4\pi^{2}\Gamma\left(\frac{1}{2}\right)\Gamma\left(1\right)}{4\pi\Gamma\left(\frac{3}{2}\right)\Gamma\left(1\right)} \\
	              =& \frac{m}{2\abs{m}}\frac{\Gamma\left(\frac{1}{2}\right)}{\Gamma\left(\frac{3}{2}\right)} \\
	              =& \frac{m}{2\abs{m}}.
\end{align*}

Setting $k_{y} = 0$ instead nets us a model in class AIII. To define a topological invariant for this model we reparametrize it and switch form such that the Hamiltonian is
\begin{align*}
	\ham = k_{x}\sigma_{x} - m\sigma_{y}.
\end{align*}
The eigenstates are
\begin{align*}
	\ket{u^{-}(k)} = \frac{1}{\sqrt{2}\lambda}\mqty[
		-k_{x} - im \\
		\lambda
	],\ \ket{u^{+}(k)} = \frac{1}{\sqrt{2}\lambda}\mqty[
		k_{x} + im \\
		\lambda
	]..
\end{align*}
The projection operator onto occupied states is therefore
\begin{align*}
	P = \frac{1}{2}\mqty[
		1                           & \frac{-k_{x} - im}{\lambda} \\
		\frac{-k_{x} + im}{\lambda} & 1
	],
\end{align*}
from which we find
\begin{align*}
	Q = \frac{1}{\lambda}\mqty[
		0          & k_{x} + im \\
		k_{x} - im & 0
	].
\end{align*}
The Hamiltonian commutes with $\sigma_{z}$, which is diagonal in the chosen basis, and thus we find
\begin{align*}
	q = \frac{k_{x} + im}{\lambda}.
\end{align*}
The winding number is given by the form
\begin{align*}
	\omega_{1} =& \frac{i}{2\pi}\tr(q^{-1}\df{q}) \\
	           =& \frac{i}{2\pi}\frac{\lambda}{k_{x} + im}\left(\frac{1}{\lambda} - \frac{(k_{x} + im)k_{x}}{\lambda^{3}}\right)\df{k_{x}} \\
	           =& \frac{i}{2\pi}\frac{k_{x} - im}{\lambda}\frac{\lambda^{2} - (k_{x} + im)k_{x}}{\lambda^{3}}\df{k_{x}} \\
	           =& \frac{im}{2\pi}\frac{k_{x} - im}{\lambda}\frac{m - ik_{x}}{\lambda^{3}}\df{k_{x}} \\
	           =& \frac{m}{2\pi}\frac{(k_{x} - im)(k_{x} + im)}{\lambda^{4}}\df{k_{x}} \\
	           =& \frac{m}{2\pi\lambda^{2}}\df{k_{x}},
\end{align*}
and we have
\begin{align*}
	\nu_{1} =& \inte{}{}\omega_{1} \\
	        =& \inte{-\infty}{\infty}\dd{k_{x}}\frac{m}{2\pi\lambda^{2}} \\
	        =& m\frac{\Gamma\left(\frac{1}{2}\right)^{2}}{2\sqrt{\pi}\Gamma\left(1\right)\Gamma\left(\frac{1}{2}\right)}(m^{2})^{-\frac{1}{2}} \\
	        =& \frac{m}{2\abs{m}}.
\end{align*}
To compute the Chern-Simons invariant, we need the Berry connection for the occupied states. Reusing a previous calculation we find
\begin{align*}
	A =& -\frac{im}{2\lambda^{2}}\df{k_{x}}.
\end{align*}
The Chern-Simons form is then given by
\begin{align*}
	Q_{1} = \frac{i}{2\pi}\inte{0}{1}\dd{t}\tr(A) = \frac{i}{2\pi}\tr(A),
\end{align*}
and the Chern-Simons invariant is
\begin{align*}
	\text{CS}_{1} =& \inte{}{}Q_{1} \\
	              =& \frac{1}{2\pi}\inte{-\infty}{\infty}\dd{k_{x}}\frac{m}{2\lambda^{2}} \\
	              =& \frac{m}{4\abs{m}}.
\end{align*}
This is half the winding number, and this is in fact not a coincidence. The Wilson loop is then given by
\begin{align*}
	W = e^{\pm i\frac{\pi}{2}}.
\end{align*}

\paragraph{Summary of Articles}
The \href{https://journals-aps-org.focus.lib.kth.se/prb/pdf/10.1103/PhysRevB.102.245113}{first article} is about the Berry phase in gapped systems, studied through effective field theory. Promoting parameters of the theory to background fields nets new terms to the effective action, so-called Weiss-Zumino-Witten terms. Considering such terms yields constraints on the phase diagram of the theory, and in particular implies the existence of gapless points which are stable under (some kinds of) deformations. Such points are called diabolical points. For theories with finite degrees of freedom, the existence of such points is identified using the Berry curvature. For field theories one generalization of the Berry phase is the WZW terms appearing in an effective action.

The WZW terms can be related to the ordinary Berry phase by considering interfaces in the model and performing dimensional reduction along these. The result is that the integrals of the Berry curvature are the same for the full model and the effective model along the interface. By that argument these terms also distinguish themselves from the higher Berry curvature, which is mathematically distinct from the usual Berry curvature.

The \href{https://iopscience.iop.org/article/10.1088/1367-2630/12/6/065010/pdf}{second article} is about dimensional reduction of topological insulators. It demonstrates how Hamiltonians that differ with respect to dimensionality and symmetry properties can be related via dimensional reduction.
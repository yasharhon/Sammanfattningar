\section{The Renormalization Group}

\paragraph{The Idea}
The concept which we will study considers models on a $d$-dimensional lattice with a set of degrees of freedom $\sigma_{i}$ and coupling constants $K_{\alpha}$. We describe the system with the dimensionless Hamiltonian
\begin{align*}
	H = -\beta\ham = \sum\limits_{\alpha = 1}^{n}K_{\alpha}\psi_{\alpha}(\sigma)
\end{align*}
where the functions $\psi_{\alpha}(\sigma)$ describe one particular kind of interaction. As an example, the Ising model with coupling all over the lattice may have one function $\psi_{1}$ which contains all nearest-neighbour interactions, one function $\psi_{2}$ which describes next-to-nearest neighbours and so on. We suppose that there exists a transformation $R_{b}(\sigma)$ which rescales the system and introduces degrees of freedom $\sigma^{\prime}$ that are a factor of $b^{d}$ fewer than the original degrees of freedom. We also suppose that it works in such a way that the Hamiltonian expressed in the new degrees of freedom has the same form as that describing the original degrees of freedom, up to the addition of constants. Such a transform is called a renormalization transform. Its effect on the dimensionless Hamiltonian is
\begin{align*}
	H^{\prime} = Ng(K_{\alpha}) + \sum\limits_{\alpha = 1}^{n}K_{\alpha}^{\prime}\psi_{\alpha}(\sigma^{\prime}),
\end{align*}
where $\sigma^{\prime}$ is the set of reduced degrees of freedom, which must have the same algebraic property as the non-reduced ones, and we have new coupling coefficients which are functions of the old. Similarly, the free energy may be written as
\begin{align*}
	-\frac{\beta}{N}G\left(N, K_{\alpha}\right) = f\left(K_{\alpha}\right) = g(K_{\alpha}) + b^{-d}f\left(K_{\alpha}^{\prime}\right).
\end{align*}
Repeated application of such a transformation will yield
\begin{align*}
	-\frac{\beta}{N}G\left(N, K_{\alpha}\right) = \sum\limits_{j = 0}b^{-jd}g(K_{\alpha, j}).
\end{align*}
In other words, by determining the sequence of coupling constants and the function $g$, the free energy may be written as a series of this form.

A characteristic feature of renormalization transforms is that $R_{b}^{2}(\sigma) = R_{b^{2}}(\sigma)$. This was a motivation to dub the set of all renormalization transforms the renormalization group. This is a misnomer, however, as there is no inverse renormalization transform - the price we pay for doing this is losing information about microscopic details of the system.

\paragraph{Fixed Point Analysis}
%TODO: Complete
Consider a transformation as described above. There exist values of the coupling constants such that $K_{\alpha}^{\prime}(K_{\alpha}) = K_{\alpha}$. These are called fixed points. The renormalization transform causes the coupling constants to flow in coupling constant space. Depending on the direction of this flow, the fixed point is termed either stable or unstable.

We will now study the critical points of such model. To do this, consider a model described by two coupling constants. The set of critical points for this model will form a curve in coupling constant space. Changing the temperature for a fixed system corresponds to moving along a straight line in this space. We will try to relate the flow under renormalization transformations to that of changing temperature.

Under a renormalization transform, the coupling constant flow cannot approach the critical line, as the correlation length there is infinite and generally decreased by a renormalization transform (when measured in transformed length units). The long-range order may not be changed by such transforms either, hence the flow cannot make points cross the critical line. Certain points on the critical line may be fixed points, but generally all of them are not. Hence the flow around a fixed point is parallel to the critical line and away from the fixed point, or towards the fixed point for points starting on the critical line.

To proceed, consider some particular fixed point $K_{1}^{\star}, K_{2}^{\star}$ and a flow close to this point. Denoting the functions $R_{\alpha}$, which perform the flow, we introduce displacements $\Delta K$ from the critical point, and obtain to first order
\begin{align*}
	K_{1}^{\prime} = R_{1}(K_{1}^{\star} + \Delta K_{1}, K_{2}^{\star} + \Delta K_{2}) = K_{1}^{\star} + \Delta K_{1}\pdv{R_{1}}{K_{1}} + \Delta K_{2}\pdv{R_{1}}{K_{2}},
\end{align*}
with a similar expression for $K_{2}^{\prime}$. Introducing the matrix
\begin{align*}
M_{ij} = \pdv{R_{i}}{K_{j}}
\end{align*}
and the displacements
\begin{align*}
	\Delta K_{1}^{\prime} = K_{1}^{\prime} - K_{1}^{\star}
\end{align*}
we have
\begin{align*}
	\Delta K_{1}^{\prime} = M_{11}\Delta K_{1} + M_{12}\Delta K_{2},\ \Delta K_{2}^{\prime} = M_{21}\Delta K_{1} + M_{22}\Delta K_{2}.
\end{align*}
To continue, we change variables as determined by the eigenvectors of $M$. Naming these $\vb*{\phi}_{1}$ and $\vb*{\phi}_{2}$, the new variables, called scaling fields, are
\begin{align*}
	U_{i} = \phi_{1, i}\Delta K_{1} + \phi_{2, i}\Delta K_{2}.
\end{align*}
The property of renormalization transforms imply that the corresponding eigenvalues are $\lambda_{i} = b^{y_{i}}$, hence
\begin{align*}
	U_{i}^{\prime} = b^{y_{i}}U_{i}.
\end{align*}

At this point we take a break to obtain an explicit expression for the exponents. We have
\begin{align*}
	y_{i} = \frac{\ln(\lambda_{i})}{\ln(b)}.
\end{align*}
In other words, they are given by the structure of the fixed points.

Due to our assumptions about the flow close to the fixed point, one of the $y_{i}$ must be positive while the other is not. The other exponent corresponds to an eigenvector which is tangential to the critical line at the fixed point. The possibility of the non-positive exponent being zero corresponds to a line of fixed points.

Returning to the energy function, we expect $g$ to be analytic as it only contains information about short-range fluctuations, hence the singular part of $f$ satisfies the recursion relation
\begin{align*}
	f\left(K_{\alpha}\right) = b^{-d}f\left(K_{\alpha}^{\prime}\right).
\end{align*}
Close to the critical point, this may be written as
\begin{align*}
	f(U_{1}^{\prime}, U_{2}^{\prime}) = b^{-d}f\left(b^{y_{1}}U_{1}^{\prime}, b^{y_{2}}U_{2}^{\prime}\right).
\end{align*}
Suppose now that a change in temperature affects only $U_{1}$. At any point on the critical line close to the one around which we linearized, we must have $U_{1} = 0$. The converse is true elsewhere in the surrounding. Hence we may identify $U_{1} = t$ and obtain.
\begin{align*}
	f(t, U_{2}^{\prime}) = b^{-d}f\left(b^{y_{1}}t, b^{y_{2}}U_{2}^{\prime}\right).
\end{align*}
Similarly, $U_{2}$ may be identified with some other variable. By combining this with the previously obtained expressions for the exponents, we may obtain scaling exponents and thus critical exponents from the structure of the fixed points.

As renormalization transforms are expected to either enhance or weaken long-range interactions, we must have $y_{1} > 0$. Hence by approaching criticality at fixed $U_{2}$, we obtain that the flow is in fact independent of $U_{2}$ (you can verify this by using a scaling argument analogous to the ones previously performed). Hence, all systems whose Hamiltonians flow to the same critical fixed points have the same critical exponents, which is reminiscent of the previously studied universality arguments.

The previous analysis generalizes to higher-dimensional coupling constant spaces.

\paragraph{Decimation of the Ising Chain}
Before proceeding, we define the dimensionless operator
\begin{align*}
	H = -\beta\ham = K\sum\limits_{i}\sigma_{i}\sigma_{i + 1} + \frac{1}{2}h\sum\limits_{i}\sigma_{i} + \sigma_{i + 1}.
\end{align*}
When computing the partition function, we may do this by first summing over spins with odd indices. For any one of these, we obtain the (partial) sum
\begin{align*}
	2\cosh(K(\sigma_{i - 1} + \sigma_{i + 1}) + h)e^{\frac{1}{2}h\sum\limits_{i}\sigma_{i - 1} + \sigma_{i + 1}}.
\end{align*}
The partition function is thus
\begin{align*}
	Z &= tr(e^{H}) \\
	  &= \sum\limits_{\sigma_{1}}\sum\limits_{\sigma_{3}}\dots\sum\limits_{\sigma_{2}}\sum\limits_{\sigma_{4}}\dots e^{K\sum\limits_{i}\sigma_{i}\sigma_{i + 1} + \frac{1}{2}h\sum\limits_{i}\sigma_{i} + \sigma_{i + 1}} \\
	  &= \sum\limits_{\sigma_{1}}\sum\limits_{\sigma_{3}}\dots\sum\limits_{\sigma_{N - 1}}\prod\limits_{i = 1}^{\frac{N}{2}}2e^{\frac{1}{2}h(\sigma_{2i - 1} + \sigma_{2i + 1})}\cosh(K(\sigma_{2i - 1} + \sigma_{2i + 1}) + h).
\end{align*}
Reindexing according to $2i - 1 \to i,\ 2i + 1 \to i + 1$ and introducing the new number of degrees of freedom $N^{\prime} = \frac{1}{2}N$, we obtain
\begin{align*}
	Z &= \sum\limits_{\{\sigma_{1}\}}\prod\limits_{i = 1}^{N^{\prime}}2e^{\frac{1}{2}h(\sigma_{i} + \sigma_{i + 1})}\cosh(K(\sigma_{i} + \sigma_{i + 1}) + h).
\end{align*}
This is a Hamiltonian of an Ising chain if we can identify quantities $g, K^{\prime}, h^{\prime}$ such that
\begin{align*}
	2e^{\frac{1}{2}h(\sigma_{i} + \sigma_{i + 1})}\cosh(K(\sigma_{i} + \sigma_{i + 1}) + h) &= e^{2g + K^{\prime}\sigma_{i}\sigma_{i + 1} + \frac{1}{2}h^{\prime}(\sigma_{i} + \sigma_{i + 1})}.
\end{align*}
This must be true for any value of the involved functions $\sigma_{i} + \sigma_{i + 1},\ \sigma_{i}\sigma_{i + 1}$. There are three possible combinations of these values, yielding the four equations
\begin{align*}
	2e^{h}\cosh(2K + h)   &= e^{2g + K^{\prime} + h^{\prime}}, \\
	2e^{-h}\cosh(-2K + h) &= e^{2g + K^{\prime} - h^{\prime}}, \\
	2\cosh(h)             &= e^{2g - K^{\prime}}.
\end{align*}
Multiplying the former yields
\begin{align*}
	4\cosh(2K + h)\cosh(2K - h) &= e^{4g + 2K^{\prime}}.
\end{align*}
Multiplying or dividing by the square of the latter yields
\begin{align*}
	16\cosh(2K + h)\cosh(2K - h)\cosh[2](h)        &= e^{8g}, \\
	\frac{\cosh(2K + h)\cosh(2K - h)}{\cosh[2](h)} &= e^{4K^{\prime}}.
\end{align*}
We thus have
\begin{align*}
	K^{\prime} &= \frac{1}{4}\ln(\frac{\cosh(2K + h)\cosh(2K - h)}{\cosh[2](h)}), \\
	g          &= \frac{1}{8}\ln(16\cosh(2K + h)\cosh(2K - h)\cosh[2](h)).
\end{align*}
Inserting this into one of the former yields
\begin{align*}
	h^{\prime} &= h - 2g - K^{\prime} + \ln(2\cosh(2K + h)) \\
	           &= h - \frac{1}{4}\ln(16\cosh(2K + h)\cosh(2K - h)\cosh[2](h)) - \frac{1}{4}\ln(\frac{\cosh(2K + h)\cosh(2K - h)}{\cosh[2](h)}) + \ln(2\cosh(2K + h)) \\
	           &= h - \frac{1}{4}\ln(16\cosh[2](2K + h)\cosh[2](2K - h)) + \ln(2\cosh(2K + h)) \\
	           &= h + \frac{1}{2}\ln(\frac{\cosh(2K + h)}{\cosh(2K - h)}).
\end{align*}
The partition function may thus be written
\begin{align*}
	Z(N, K, h) = e^{Ng(K, h)}Z\left(\frac{1}{2}N, K^{\prime}, h^{\prime}\right).
\end{align*}
Repeating this procedure generates a sequence of constants and a prefactor given by the same function $g$. Doing this an infinite number of times yields
\begin{align*}
	-\frac{\beta G}{N} = \sum\limits_{j = 0}^{\infty}\frac{1}{2^{j}}g(K_{j}, h_{j}).
\end{align*}

%TODO: Flow in constant space

\paragraph{The Cumulant Method}
For more examples, we study the Ising model on a two-dimensional triangular lattice. The dimensionless Hamiltonian is
\begin{align*}
	H = \frac{1}{2}\sum\limits_{i, j}K_{ij}\sigma_{i}\sigma_{j} + h\sum\limits_{i}\sigma_{i},
\end{align*}
where we now allow interactions throughout the lattice.

The triangular lattice may be divided into triangular blocks of three spins. The lattice of such blocks is a triangular lattice with a lattice constant a factor $\sqrt{3}$ greater than that of the original lattice. We will perform a renormalization procedure on these blocks defined by the projection operator $P(\mu_{I}, \{\sigma_{I}\})$, which transforms the spins into the block into new variables $\mu_{I}$. For our transformation to work, we must have
\begin{align*}
	e^{Ng(K, h) + H^{\prime}(\{\mu\}, K^{\prime}, h^{\prime})} = \tr\limits_{\{\sigma\}}(\left(\prod\limits_{I}P(\mu_{I}, \{\sigma_{I}\})\right)e^{H(\{\sigma\}, K , h)}).
\end{align*}
In other words, the trace over spin configurations is carried out in such a way that the configuration of new variables is pre-determined. If we require the projection operators to have trace $1$, we may trace out the new variables and reorder the summation to obtain
\begin{align*}
	\tr\limits_{\{\mu\}}(e^{Ng + H^{\prime}}) = \tr\limits_{\{\sigma\}}(e^{H}),
\end{align*}
and the free energy is preserved.

We wish to treat this system using the cumulant method, and do this by dividing the Hamiltonian into two terms
\begin{align*}
	H(\{\sigma\}, K, h) = H_{0}(\{\sigma\}, K, h) + V(\{\sigma\}, K, h).
\end{align*}
$H_{0}$ contains all terms that operate within the blocks and $V$ contains all interactions between blocks. We introduce $K_{n}$ as the coupling constant $n$-th nearest neighbours and thus have
\begin{align*}
	H_{0} = \sum\limits_{I}K_{1}(\sigma_{I, 1}\sigma_{I, 2} + \sigma_{I, 1}\sigma_{I, 3} + \sigma_{I, 2}\sigma_{I, 3}) + h(\sigma_{I, 1} + \sigma_{I, 2} + \sigma_{I, 3}),\ V = \sum\limits_{I, J, n}K_{n}\sum\limits_{\alpha, \beta}\sigma_{I, \alpha}\sigma_{J, \beta}.
\end{align*}
This yields
\begin{align*}
	\tr\limits_{\{\sigma\}}\left(\left(\prod\limits_{I}P(\mu_{I}, \{\sigma_{I}\})\right)e^{H(\{\sigma\}, K , h)}\right) = Z_{0}\expval{e^{V}}
\end{align*}
where
\begin{align*}
	Z_{0} = \tr\limits_{\{\sigma\}}\left(\left(\prod\limits_{I}P(\mu_{I}, \{\sigma_{I}\})\right)e^{H_{0}(\{\sigma\}, K , h)}\right)
\end{align*}
and the expectation value is defined in terms this partition function, i.e. considering only interactions within the block. Note that it is done for some particular configuration of the new variables. This is not yet an approximation.

%TODO: Generating function
The approximation comes now, when we introduce a so-called truncated cumulant expansion
\begin{align*}
	\expval{e^{V}} = e^{\expval{V} + \frac{1}{2!}\expval{(V - \expval{V})^{2}} + \frac{1}{3!}\expval{(V - \expval{V})^{3}} + \dots}.
\end{align*}
We name the terms in the exponent $C_{i}$. Where does this approximation come from? When computing the free energy we have
\begin{align*}
	F &= F_{0} - \kb T\ln(\expval{e^{V}}) \\
	  &= F_{0} - \kb T\ln(\expval{\sum\limits_{i = 0}^{\infty}\frac{(-1)^{i}}{i!}V^{i}}) \\
	  &= F_{0} - \kb T\ln(\sum\limits_{i = 0}^{\infty}\frac{(-1)^{i}}{i!}\expval{V^{i}}) \\
	  &= F_{0} - \kb T\ln(1 + \sum\limits_{i = 1}^{\infty}\frac{(-1)^{i}}{i!}\expval{V^{i}}) \\
	  &= F_{0} + \kb T\left(\sum\limits_{j = 1}^{\infty}\frac{(-1)^{j}}{j}\left(\sum\limits_{i = 1}^{\infty}\frac{(-1)^{i}}{i!}\expval{V^{i}}\right)^{j}\right),
\end{align*}
and working out some terms and computing the exponential should yield the correct result. It might be nice to show this.

Let us now include only nearest-neighbour interactions. We thus write the partition function as
\begin{align*}
	Z_{0} = \tr\limits_{\{\sigma\}}\left(\left(\prod\limits_{I}P(\mu_{I}, \{\sigma_{I}\})\right)e^{\sum\limits_{I}K_{1}(\sigma_{I, 1}\sigma_{I, 2} + \sigma_{I, 1}\sigma_{I, 3} + \sigma_{I, 2}\sigma_{I, 3}) + h(\sigma_{I, 1} + \sigma_{I, 2} + \sigma_{I, 3})}\right).
\end{align*}
For the renormalization transform to work, $Z_{0}$ must represent the interaction-free parts of the renormalized Hamiltonians. We must therefore have
\begin{align*}
	Z_{0} = \prod\limits_{I}e^{A + B\mu_{i}}.
\end{align*}
Asssuming the new variables to be designated according to a majority rule, we fix these. By tracing out the individual blocks we obtain
\begin{align*}
	e^{A + B} = e^{3K + 3h} + 3e^{-K + h},\ e^{A - B} = e^{3K - 3h} + 3e^{-K - h},
\end{align*}
with solutions
\begin{align*}
	A = \frac{1}{2}\ln((e^{3K + 3h} + 3e^{-K + h})(e^{3K - 3h} + 3e^{-K - h})),\ B = \frac{1}{2}\ln(\frac{e^{3K + 3h} + 3e^{-K + h}}{e^{3K - 3h} + 3e^{-K - h}}).
\end{align*}
As the blocks do not interact in the base Hamiltonian, we obtain
\begin{align*}
	\expval{V} = \sum\limits_{I, J, n}K_{n}\sum\limits_{\alpha, \beta}\expval{\sigma_{I, \alpha}\sigma_{J, \beta}} = \sum\limits_{I, J, n}K_{n}\sum\limits_{\alpha, \beta}\expval{\sigma_{I, \alpha}}\expval{\sigma_{J, \beta}}.
\end{align*}
In particular, as there are only nearest-neighbour interactions we have
\begin{align*}
	\expval{V} = K\sum\limits_{I, J, \alpha, \beta}\expval{\sigma_{I, \alpha}}\expval{\sigma_{J, \beta}}.
\end{align*}
Translational invariance yields that all these expectation values must be equal. To reproduce a Hamiltonian of the same form in the new variables, we must have
\begin{align*}
	\expval{\sigma_{I, \alpha}} = C + D\mu_{I}.
\end{align*}
These expectation values can be calculated directly from $Z_{0}$ according to
\begin{align*}
	\expval{\sigma} = \frac{1}{e^{A + B\mu_{I}}}\sum\limits_{\alpha}\sigma_{1}e^{K(\sigma_{1}\sigma_{2} + \sigma_{1}\sigma_{3} + \sigma_{2}\sigma_{3}) + h(\sigma_{1} + \sigma_{2} + \sigma_{3})},
\end{align*}
where we chose some arbitrary spin with respect to which we compute the expectation values. The two choices of the new variables yield
\begin{align*}
	C + D &= \frac{1}{e^{A + B}}(e^{3K + 3h} + 2e^{-K + h} - e^{-K + h}) = \frac{e^{3K + 3h} + e^{-K + h}}{e^{3K + 3h} + 3e^{-K + h}}, \\
	C - D &= \frac{1}{e^{A - B}}(-e^{-3K - 3h} - 2e^{-K - h} + e^{-K - h}) = -\frac{e^{-3K - 3h} + e^{-K - h} }{e^{3K - 3h} + 3e^{-K - h}},
\end{align*}
with solution
\begin{align*}
	C &= \frac{1}{2}\left(\frac{e^{3K + 3h} + e^{-K + h}}{e^{3K + 3h} + 3e^{-K + h}} - \frac{e^{-3K - 3h} + e^{-K - h} }{e^{3K - 3h} + 3e^{-K - h}}\right), \\
	D &= \frac{1}{2}\left(\frac{e^{3K + 3h} + e^{-K + h}}{e^{3K + 3h} + 3e^{-K + h}} + \frac{e^{-3K - 3h} + e^{-K - h} }{e^{3K - 3h} + 3e^{-K - h}}\right).
\end{align*}

This is combined with the renormalization anzats to yield
\begin{align*}
	Ng(K, h) + H^{\prime}(\{\mu\}, K^{\prime}, h^{\prime}) &= \frac{1}{3}NA(K, h) + B\sum\limits_{I}\mu_{I} + 2K\sum\limits_{\text{nn}(I, J)}(C + D\mu_{I})(C + D\mu_{J}) \\
	                                                       &= \frac{1}{3}NA(K, h) + B\sum\limits_{I}\mu_{I} + 2K\sum\limits_{\text{nn}(I, J)}C^{2} + CD(\mu_{I} + \mu_{J}) + D^{2}\mu_{I}\mu_{J}.
\end{align*}
where we have added a factor $2$ to the interaction due to double counting when tracing out the individual $\sigma$. We may also relabel one of the $\mu$ in the sums on the right-hand side. Somehow double counting is an issue for certain terms, and we obtain
\begin{align*}
	Ng(K, h) + H^{\prime}(\{\mu\}, K^{\prime}, h^{\prime}) &= \frac{1}{3}NA(K, h) + 2KNC^{2} + (B + 12KCD)\sum\limits_{I}\mu_{I} + 2KD^{2}\sum\limits_{\text{nn}(I, J)}\mu_{I}\mu_{J}.
\end{align*}
This yields the recursion relations
\begin{align*}
	g(K, h)    &= \frac{1}{3}A(K, h) + 2KC^{2}(K, h), \\
	K^{\prime} &= 2KD^{2}(K, h), \\
	h^{\prime} &= B(K, h) + 12KC(K, h)D(K, h),\ .
\end{align*}

For $h = 0$, we obtain $B = C = 0$, and thus
\begin{align*}
	K^{\prime} = 2K\left(\frac{e^{3K} + e^{-K}}{e^{3K} + 3e^{-K}}\right)^{2},\ h^{\prime} = 0.
\end{align*}
For small $K$ the recursion becomes $K^{\prime} = \frac{1}{2}K$, and for large $K$ it is $K^{\prime} = 2K$, meaning that the flow reverses at some point. The final fixed point is $K = 0.3356$. Using the fact that $b = \sqrt{3}$ one obtains  $y_{t} = 0.882,\ y_{h} = 2.034$. These results do not agree particularly well with the exact results, but nevertheless demonstrate the power of the framework.

%TODO: Finish
Next we consider the second-order approximation.

\paragraph{$\epsilon$-Expansion}
Consider some system of $N$Â vectorized degrees of freedom on a $d$-dimensional lattice with lattice parameter $a$. The  Hamiltonian is given by
\begin{align*}
	\ham = -\sum\limits{\vb{r}}\sum\limits{\vb{a}}J_{\vb{a}}\vb{S}_{\vb{r}}\cdot\vb{S}_{\vb{a}} - h\sum\limits{\vb{r}}J_{\vb{a}}\vb{S}_{\vb{r}, \alpha},
\end{align*}
where all sums are performed over all lattice vectors. The vectors $\vb{r}$ and $\vb{a}$ refer to points on a lattice and $\alpha$ is some particular direction in which the field points. We introduce a weighting function $W$ to allow the magnitudes of the vectors $\vb{S}$ to vary. The partition function is thus
\begin{align*}
	Z = \left(\prod\limits_{\vb{r}}\integ[d]{}{}{\vb{S}_{\vb{r}}}{W(S_{\vb{r}})}\right)e^{-\beta\ham}.
\end{align*}
To proceed, we choose new variables according to
\begin{align*}
	\vb{S}_{\vb{r}} = \frac{1}{\sqrt{N}}\sum\limits_{\vb{q}}\vb{S}_{\vb{q}}e^{i\vb{q}\cdot\vb{r}},
\end{align*}
where the vectors $\vb{q}$ are restricted to the first Brillouin zone of the simple cubic lattice with the same parameters. We also choose a weighting function
\begin{align*}
	W(S) = e^{-\frac{1}{2}bS^{2} - cS^{4}},
\end{align*}
as the parameters of such a function may be chosen such that the weighting is highly localized about some particular length. We now introduce the effective Hamiltonian
%TODO: Check
\begin{align*}
	H &= -\beta\ham + \sum\limits_{\vb{r}}W(S_{\vb{r}}) \\
	  &= -\sum\limits_{\vb{q}}\left(\frac{1}{2}b - K(\vb{q})\right)\vb{S}_{\vb{q}}\cdot\vb{S}_{-\vb{q}} - \sum\limits_{\vb{q}_{1}, \vb{q}_{2}, \vb{q}_{3}}(\vb{S}_{\vb{q}_{1}}\cdot\vb{S}_{\vb{q}_{2}})(\vb{S}_{\vb{q}_{3}}\cdot\vb{S}_{-\vb{q}_{1} - \vb{q}_{2} - \vb{q}_{3}}) + \sqrt{N}h_{0}S_{\vb{0}}^{\alpha}
\end{align*}
where
\begin{align*}
	K(\vb{q}) = \beta\sum\limits_{\vb{a}}J(\vb{a})e^{-i\vb{q}\cdot\vb{a}},\ h_{0} = \beta h.
\end{align*}
By introducing $\beta J(\vb{a}) = \frac{1}{2}K_{0}$ only for nearest-neighbours and restricting ourselves to a simple cubic lattice we have in the long-wavelength limit
\begin{align*}
	K(\vb{q}) = K_{0}\sum\limits_{j = 1}^{d}dK_{0} - \frac{1}{2}K_{0}a^{2}q^{2}.
\end{align*}
We may somehow rescale things to obtain
\begin{align*}
	H &= -\frac{1}{2}\sum\limits_{\vb{q}}\left(r + q^{2}\right)\vb{S}_{\vb{q}}\cdot\vb{S}_{-\vb{q}} - \frac{u}{N}\sum\limits_{\vb{q}_{1}, \vb{q}_{2}, \vb{q}_{3}}(\vb{S}_{\vb{q}_{1}}\cdot\vb{S}_{\vb{q}_{2}})(\vb{S}_{\vb{q}_{3}}\cdot\vb{S}_{-\vb{q}_{1} - \vb{q}_{2} - \vb{q}_{3}}) + \sqrt{N}h_{0}S_{\vb{0}}^{\alpha}
\end{align*}
for
\begin{align*}
	r = \frac{b - 2dK_{0}}{K_{0}a^{2}},\ h = \frac{h_{0}}{\sqrt{K_{0}a^{2}}},\ u = \frac{c}{K_{0}^{2}a^{4}}.
\end{align*}

We now proceed with the case $u = 0$, known as the Gaussian model. Its partition function is given by
\begin{align*}
	Z = \left(\prod\limits_{\vb{q}}\integ[d]{}{}{\vb{S}_{\vb{q}}}{}\right)e^{-\frac{1}{2}\sum\limits_{\vb{q}}\left(r + q^{2}\right)\vb{S}_{\vb{q}}\cdot\vb{S}_{-\vb{q}} + \sqrt{N}h_{0}S_{\vb{0}}^{\alpha}}.
\end{align*}
Rather than computing this exactly, we will approach it with the renormalization group. To do that, we first carry out the functional integration for all $\vb{S}_{\vb{q}}$ such that $q > q_{l} = \frac{\pi}{l}$ for some parameter $l > 1$. This corresponds to dividing the spins into blocks. The resulting partition function is
\begin{align*}
	Z = A\left(\prod\limits_{q < q_{l}}\integ[d]{}{}{\vb{S}_{q < l}}{}\right)e^{-\frac{1}{2}\sum\limits_{\vb{q}}\left(r + q^{2}\right)\vb{S}_{\vb{q}}\cdot\vb{S}_{-\vb{q}} + \sqrt{N}h_{0}S_{\vb{0}}^{\alpha}}
\end{align*}
for some constant $A$. Next we introduce $\vb{q}^{\prime} = l\vb{q}$ - in other words, we rescale lengths - and multiply the summation by a factor $l^{-d}$ to compensate for the extra degrees of freedom. The rescaled dimensionless Hamiltonian is thus
\begin{align*}
	H^{\prime} = -\frac{1}{2}\sum\limits_{\vb{q}^{\prime}}\left(r + \left(\frac{q^{\prime}}{l}\right)^{2}\right)\vb{S}_{\frac{1}{l}\vb{q}^{\prime}}\cdot\vb{S}_{-\frac{1}{l}\vb{q}^{\prime}} + \sqrt{N}h_{0}S_{\vb{0}}^{\alpha}.
\end{align*}
For this to have the same functional form as before, we must rescale the degrees of freedom according to
\begin{align*}
	\vb{S}_{\frac{1}{l}\vb{q}^{\prime}} = l^{1 + \frac{d}{2}}\vb{S}_{\vb{q}^{\prime}}.
\end{align*}
This will yield
\begin{align*}
	H^{\prime} = -\frac{1}{2}\sum\limits_{\vb{q}^{\prime}}\left(r^{\prime} + (q^{\prime})^{2}\right)\vb{S}_{\vb{q}^{\prime}}\cdot\vb{S}_{-\vb{q}^{\prime}} + \sqrt{N}h^{\prime}S_{\vb{0}}^{\alpha},\ r^{\prime} = rl^{2},\ h^{\prime} = hl^{1 + \frac{d}{2}}.
\end{align*}
Assuming $r$ to be temperature-like, we have the scaling relation
\begin{align*}
	g(t, h) = l^{-d}g(tl^{2}, hl^{1 + \frac{d}{2}}).
\end{align*}
Some critical exponents are $\alpha = 2 - \frac{d}{2},\ \beta = \frac{d}{4} - \frac{1}{2},\ \gamma = 1$.

\paragraph{The $S^{4}$ Model}
Consider an effective Hamiltonian
\begin{align*}
	H =& -\frac{1}{2}\sum\limits_{\vb{q}}(r + q^{2})\vb{S}_{\vb{q}}\cdot\vb{S}_{-\vb{q}} - \frac{u}{N}\sum\limits_{\vb{q}_{1}, \dots, \vb{q}_{3}}(\vb{S}_{\vb{q}_{1}}\cdot\vb{S}_{\vb{q}_{2}})(\vb{S}_{\vb{q}_{3}}\cdot\vb{S}_{-\vb{q}_{1} - \vb{q}_{2} - \vb{q}_{3}}) \\
	   &- \frac{w}{N^{2}}\sum\limits_{\vb{q}_{1}, \dots, \vb{q}_{3}}(\vb{S}_{\vb{q}_{1}}\cdot\vb{S}_{\vb{q}_{2}})(\vb{S}_{\vb{q}_{3}}\cdot\vb{S}_{\vb{q}_{4}})(\vb{S}_{\vb{q}_{5}}\cdot\vb{S}_{-\vb{q}_{1} - \vb{q}_{2} - \vb{q}_{3} - \vb{q}_{4} - \vb{q}_{5}}) + \dots + h\sqrt{N}S_{\vb{0}}^{\alpha}.
\end{align*}
We will handle this using a renormalization transform, but as traces over the higher-order terms are difficult to compute, we will use a cumulant expansion.

%TODO: Do this pls